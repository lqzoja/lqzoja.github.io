

<!-- else -->
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">

<title>SW_Wind&#39;s blog</title>

<script src="/js/jquery-2.0.3.min.js"></script>
<link rel="stylesheet" type="text/css" href="/css/style.css">
<!-- Mathjax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<!-- Valine -->
<script src="https://cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="/js/Valine.min.js"></script>
  </head>
  <body>
    <header>
      <div style="background-image: url(/img/author.jpg)" class="author_img"></div>
<div class="blog-title">
	<p class="title">SW_Wind&#39;s blog</p>
	<p class="subtitle">你指尖跃动的电光，是我此生不变的信仰</p>
</div>
<ul class="headerlinks">

  <li><a href="/">首页</a></li>

  <li><a href="/about">关于</a></li>

  <li><a href="/archives">档案</a></li>

</ul>
    </header>
    <div class="container">
      <div class="main">
        <div>

  
<section>
  <a href="/2017/06/02/BZOJ-1004-HNOI2008-Cards/" title="BZOJ 1004: [HNOI2008]Cards" class="link">
    <p class="desc-name"><span class="title">BZOJ 1004: [HNOI2008]Cards</span><time class="time">2017-06-02</time></p>
  </a>
  
	  
	    <div class="artc" ><h1 id="题面"><a href="#题面" class="headerlink" title="题面"></a>题面</h1><p>小春现在很清闲，面对书桌上的N张牌，他决定给每张染色，目前小春只有3种颜色：红色，蓝色，绿色。他询问Sun有多少种染色方案，Sun很快就给出了答案。进一步，小春要求染出Sr张红色，Sb张蓝色，Sg张绝色。他又询问有多少种方案，Sun想了一下，又给出了正确答案。最后小春发明了M种不同的洗牌法，这里他又问Sun有多少种不同的染色方案。两种染色方法相同当且仅当其中一种可以通过任意的洗牌法(即可以使用多种洗牌法，而每种方法可以使用多次)洗成另一种。Sun发现这个问题有点难度，决定交给你，答案可能很大，只要求出答案除以P的余数(P为质数)。</p>
<h1 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h1><p>第一行输入 5 个整数：$S_r,S_b,S_g,m,p(m\leq 60,m+1\lt p\lt 100),n=S_r+S_b+S_g$。接下来 m 行，每行描述一种洗牌法，每行有 n 个用空格隔开的整数 X1 X2 … Xn，恰为 1 到 n 的一个排列，表示使用这种洗牌法，第 i 位变为原来的 Xi 位的牌。输入数据保证任意多次洗牌都可用这 m 种洗牌法中的一种代替，且对每种洗牌法，都存在一种洗牌法使得能回到原状态。</p>
<h1 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h1><p>不同染法除以P的余数</p>
<h1 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h1><p>1 1 1 2 7<br>2 3 1<br>3 1 2</p>
<h1 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h1><p>2</p>
<h1 id="HINT"><a href="#HINT" class="headerlink" title="HINT"></a>HINT</h1><p>有2 种本质上不同的染色法RGB 和RBG，使用洗牌法231 一次可得GBR 和BGR，使用洗牌法312 一次 可得BRG和GRB。<br>100%数据满足$Max\{Sr,Sb,Sg\}\leq 20$。</p>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p>$$<br>ans=\frac{n!}{Sr!*Sb!*Sg!*(m+1)}\pmod p<br>$$<br>似乎和后面的东西没多大关系。。<br><del>别问我怎么知道的</del><br>0ms完美AC</p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight cpp"><table><tr><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">0</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">	<span class="keyword">while</span>(ch&gt;<span class="string">'9'</span>||ch&lt;<span class="string">'0'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">1</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">while</span>(ch&lt;=<span class="string">'9'</span>&amp;&amp;ch&gt;=<span class="string">'0'</span>)&#123;x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+ch-<span class="string">'0'</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">return</span> f?-x:x;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> frav[<span class="number">202</span>], p;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">inv</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b = p<span class="number">-2</span>)</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> c = <span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span>(;b;b/=<span class="number">2</span>,a=a*a%p)<span class="keyword">if</span>(b&amp;<span class="number">1</span>)c=c*a%p;</div><div class="line">	<span class="keyword">return</span> c;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> r = read(), b = read(), g = read(), m = read(); p = read();</div><div class="line">	frav[<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">200</span>; i++) frav[i] = frav[i<span class="number">-1</span>]*i%p;</div><div class="line">	<span class="keyword">int</span> n = r+b+g;</div><div class="line">	<span class="keyword">int</span> ans = frav[n]*inv(frav[r])*inv(frav[b])*inv(frav[g])*inv(m+<span class="number">1</span>)%p;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</div><div class="line">&#125;</div></pre></td></tr></table></figure></div>
	  
	  <div class="readmore"><a href="/2017/06/02/BZOJ-1004-HNOI2008-Cards/">Read More</a></div>
  
</section>


  
<section>
  <a href="/2017/05/31/BZOJ-4419-Shoi2013-发微博/" title="BZOJ 4419: [Shoi2013]发微博" class="link">
    <p class="desc-name"><span class="title">BZOJ 4419: [Shoi2013]发微博</span><time class="time">2017-05-31</time></p>
  </a>
  
	  
	    <div class="artc" ><h1 id="题面"><a href="#题面" class="headerlink" title="题面"></a>题面</h1><p>刚开通的SH微博共有n个用户（1..n标号），在短短一个月的时间内，用户们活动频繁，共有m条按时间顺序的记录：</p>
<ul>
<li>! x表示用户x发了一条微博；</li>
<li>+ x y 表示用户x和用户y成为了好友</li>
<li>- x y 表示用户x和用户y解除了好友关系</li>
</ul>
<p>当一个用户发微博的时候，所有他的好友（直接关系）都会看到他的消息。<br>假设最开始所有人之间都不是好友关系，记录也都是合法的（即+ x y时x和y一定不是好友，而- x y时x和y一定是好友）。<br>问这m条记录发生之后，每个用户分别看到了多少条消息。</p>
<h1 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h1><p>第1行2个整数n,m。<br>接下来m行，按时间顺序读入m条记录，每条记录的格式如题目所述，用空格隔开。</p>
<h1 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h1><p>输出一行n个用空格隔开的数（行末无空格），第i个数表示用户i最后看到了几条消息。</p>
<h1 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h1><p>2 8<br>! 1<br>! 2<br>+ 1 2<br>! 1<br>! 2<br>- 1 2<br>! 1<br>! 2</p>
<h1 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h1><p>1 1</p>
<h1 id="HINT"><a href="#HINT" class="headerlink" title="HINT"></a>HINT</h1><p>只有第4和第5条记录对应的消息被看到过。其他消息发送时，1和2不是好友。<br>对100%的数据，$N\leq 200000,M\leq 500000$</p>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p>暴力即可。。。代码奇短无比。。<br>注意PE，行末不能有空格和回车</p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight cpp"><table><tr><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 200007</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> M 500007</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> zyy 1000000007</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">0</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">	<span class="keyword">while</span>(ch&gt;<span class="string">'9'</span>||ch&lt;<span class="string">'0'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">1</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">while</span>(ch&lt;=<span class="string">'9'</span>&amp;&amp;ch&gt;=<span class="string">'0'</span>)&#123;x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+ch-<span class="string">'0'</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">return</span> f?-x:x;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> x[M], y[M], a[N], b[N], op[M];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> n = read(), m = read();</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)&#123;</div><div class="line">		op[i] = getchar(); x[i] = read();</div><div class="line">		<span class="keyword">if</span>(op[i] != <span class="string">'!'</span>) y[i] = read();</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = m; i; i--)</div><div class="line">		<span class="keyword">if</span>(op[i] == <span class="string">'!'</span>) b[x[i]]++;</div><div class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(op[i] == <span class="string">'+'</span>) a[x[i]] += b[y[i]], a[y[i]] += b[x[i]];</div><div class="line">		<span class="keyword">else</span> a[x[i]] -= b[y[i]], a[y[i]] -= b[x[i]];</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d"</span>, a[<span class="number">1</span>]);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++)</div><div class="line">		<span class="built_in">printf</span>(<span class="string">" %d"</span>, a[i]);</div><div class="line">&#125;</div></pre></td></tr></table></figure></div>
	  
	  <div class="readmore"><a href="/2017/05/31/BZOJ-4419-Shoi2013-发微博/">Read More</a></div>
  
</section>


  
<section>
  <a href="/2017/05/26/BZOJ-4562-Haoi2016-食物链/" title="BZOJ 4562: [Haoi2016]食物链" class="link">
    <p class="desc-name"><span class="title">BZOJ 4562: [Haoi2016]食物链</span><time class="time">2017-05-26</time></p>
  </a>
  
	  
	    <div class="artc" ><h1 id="题面"><a href="#题面" class="headerlink" title="题面"></a>题面</h1><p>如图所示为某生态系统的食物网示意图，据图回答第1小题<br>现在给你n个物种和m条能量流动关系，求其中的食物链条数。<br>物种的名称为从1到n编号<br>M条能量流动关系形如<br>a1 b1<br>a2 b2<br>a3 b3<br>……<br>am-1 bm-1<br>am bm<br>其中ai bi表示能量从物种ai流向物种bi,注意单独的一种孤立生物不算一条食物链</p>
<h1 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h1><p>第一行两个整数n和m,接下来m行每行两个整数ai bi描述m条能量流动关系。<br>（数据保证输入数据符号生物学特点，且不会有重复的能量流动关系出现）<br>$1\leq N\leq 100000,0\leq m\leq 200000$<br>题目保证答案不会爆 int</p>
<h1 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h1><p>一个整数即食物网中的食物链条数</p>
<h1 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h1><p>10 16<br>1 2<br>1 4<br>1 10<br>2 3<br>2 5<br>4 3<br>4 5<br>4 8<br>6 5<br>7 6<br>7 9<br>8 5<br>9 8<br>10 6<br>10 7<br>10 9</p>
<h1 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h1><p>9</p>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p>拓扑傻逼题<br>不过HAOI是什么？？</p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight cpp"><table><tr><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 100007</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">0</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">	<span class="keyword">while</span>(ch&gt;<span class="string">'9'</span>||ch&lt;<span class="string">'0'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">1</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">while</span>(ch&lt;=<span class="string">'9'</span>&amp;&amp;ch&gt;=<span class="string">'0'</span>)&#123;x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+ch-<span class="string">'0'</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">return</span> f?-x:x;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> head[N], to[N&lt;&lt;<span class="number">1</span>], nxt[N&lt;&lt;<span class="number">1</span>], cnt, ans, dp[N], in[N], a[N];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</div><div class="line">	to[++cnt] = y; nxt[cnt] = head[x];</div><div class="line">	head[x] = cnt; in[y]++;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = head[x]; i; i = nxt[i])&#123;</div><div class="line">		dp[to[i]] += dp[x];</div><div class="line">		<span class="keyword">if</span>(!--in[to[i]]) dfs(to[i]);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> n = read(), m = read();</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, x, y; i &lt;= m; i++)&#123;</div><div class="line">		x = read(); y = read();</div><div class="line">		add(x, y);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</div><div class="line">		<span class="keyword">if</span>(!in[i]&amp;&amp;head[i])</div><div class="line">			a[++a[<span class="number">0</span>]] = i;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= a[<span class="number">0</span>]; i++)</div><div class="line">			dp[a[i]] = <span class="number">1</span>, dfs(a[i]);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</div><div class="line">		<span class="keyword">if</span>(!head[i]) ans += dp[i];</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</div><div class="line">&#125;</div></pre></td></tr></table></figure></div>
	  
	  <div class="readmore"><a href="/2017/05/26/BZOJ-4562-Haoi2016-食物链/">Read More</a></div>
  
</section>


  
<section>
  <a href="/2017/05/25/BZOJ-2743-HEOI2012-采花/" title="BZOJ 2743: [HEOI2012]采花" class="link">
    <p class="desc-name"><span class="title">BZOJ 2743: [HEOI2012]采花</span><time class="time">2017-05-25</time></p>
  </a>
  
	  
	    <div class="artc" ><h1 id="题面"><a href="#题面" class="headerlink" title="题面"></a>题面</h1><p>萧芸斓是Z国的公主，平时的一大爱好是采花。<br>今天天气晴朗，阳光明媚，公主清晨便去了皇宫中新建的花园采花。花园足够大，容纳了n朵花，花有c种颜色（用整数1-c表示），且花是排成一排的，以便于公主采花。公主每次采花后会统计采到的花的颜色数，颜色数越多她会越高兴！同时，她有一癖好，她不允许最后自己采到的花中，某一颜色的花只有一朵。为此，公主每采一朵花，要么此前已采到此颜色的花，要么有相当正确的直觉告诉她，她必能再次采到此颜色的花。由于时间关系，公主只能走过花园连续的一段进行采花，便让女仆福涵洁安排行程。福涵洁综合各种因素拟定了m个行程，然后一一向你询问公主能采到多少朵花（她知道你是编程高手，定能快速给出答案！），最后会选择令公主最高兴的行程（为了拿到更多奖金！）。</p>
<h1 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h1><p>第一行四个空格隔开的整数n、c以及m。接下来一行n个空格隔开的整数，每个数在[1, c]间，第i个数表示第i朵花的颜色。接下来m行每行两个空格隔开的整数l和r（l ≤ r），表示女仆安排的行程为公主经过第l到第r朵花进行采花。</p>
<h1 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h1><p>共m行，每行一个整数，第i个数表示公主在女仆的第i个行程中能采到的花的颜色数。</p>
<h1 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h1><p>5 3 5<br>1 2 2 3 1<br>1 5<br>1 2<br>2 2<br>2 3<br>3 5</p>
<h1 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h1><p>2<br>0 0 1 0</p>
<h1 id="HINT"><a href="#HINT" class="headerlink" title="HINT"></a>HINT</h1><p>【样例说明】</p>
<ul>
<li>询问[1, 5]：公主采颜色为1和2的花，由于颜色3的花只有一朵，公主不采；</li>
<li>询问[1, 2]：颜色1和颜色2的花均只有一朵，公主不采；</li>
<li>询问[2, 2]：颜色2的花只有一朵，公主不采；</li>
<li>询问[2, 3]：由于颜色2的花有两朵，公主采颜色2的花；</li>
<li>询问[3, 5]：颜色1、2、3的花各一朵，公主不采。</li>
</ul>
<p>【数据范围】<br>对于$100\%$的数据，$1\leq n\leq 10^6,c\leq n,m\leq 10^6$。</p>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p>出题卡莫队我*****<br>那么只能换一种方法了。<br>预处理一下每朵花下一个相同颜色出现的位置。<br>然后把询问按左边界排序，用树状数组搞一波就好了。<br><del>垃圾题目降我AC率</del></p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight cpp"><table><tr><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 1000020</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">0</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">	<span class="keyword">while</span>(ch&gt;<span class="string">'9'</span>||ch&lt;<span class="string">'0'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">1</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">while</span>(ch&lt;=<span class="string">'9'</span>&amp;&amp;ch&gt;=<span class="string">'0'</span>)&#123;x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+ch-<span class="string">'0'</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">return</span> f?-x:x;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> a[N], ans[N], c[N], pos[N], nxt[N], vis[N];</div><div class="line"><span class="keyword">struct</span> node&#123;</div><div class="line">	<span class="keyword">int</span> l, r, id;</div><div class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> node &amp;b) <span class="keyword">const</span> &#123;</div><div class="line">		<span class="keyword">return</span> l &lt; b.l;</div><div class="line">	&#125;</div><div class="line">&#125;asks[N];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> v)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(!x) <span class="keyword">return</span>;</div><div class="line">	<span class="keyword">for</span>(;x&lt;N;x+=x&amp;-x)c[x]+=v;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> ans = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span>(;x;x^=x&amp;-x)ans+=c[x];</div><div class="line">	<span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> n = read(), c = read(), m = read();</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) a[i] = read();</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = n; i; i--) nxt[i] = pos[a[i]], pos[a[i]] = i;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="keyword">if</span>(!vis[a[i]]) add(nxt[i], vis[a[i]]=<span class="number">1</span>);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)&#123;</div><div class="line">		asks[i].id = i;</div><div class="line">		asks[i].l = read();</div><div class="line">		asks[i].r = read();</div><div class="line">	&#125;</div><div class="line">	sort(asks+<span class="number">1</span>, asks+m+<span class="number">1</span>);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, now = <span class="number">0</span>; i &lt;= m; i++)&#123;</div><div class="line">		<span class="keyword">while</span>(now &lt; asks[i].l)&#123;</div><div class="line">			<span class="keyword">if</span>(nxt[now])&#123;</div><div class="line">				add(nxt[now], <span class="number">-1</span>);</div><div class="line">				add(nxt[nxt[now]], <span class="number">1</span>);</div><div class="line">			&#125;</div><div class="line">			now++;</div><div class="line">		&#125;</div><div class="line">		ans[asks[i].id] = ask(asks[i].r);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans[i]);</div><div class="line">&#125;</div></pre></td></tr></table></figure></div>
	  
	  <div class="readmore"><a href="/2017/05/25/BZOJ-2743-HEOI2012-采花/">Read More</a></div>
  
</section>


  
<section>
  <a href="/2017/05/25/BZOJ-1055-HAOI2008-玩具取名/" title="BZOJ 1055: [HAOI2008]玩具取名" class="link">
    <p class="desc-name"><span class="title">BZOJ 1055: [HAOI2008]玩具取名</span><time class="time">2017-05-25</time></p>
  </a>
  
	  
	    <div class="artc" ><h1 id="题面"><a href="#题面" class="headerlink" title="题面"></a>题面</h1><p>某人有一套玩具，并想法给玩具命名。首先他选择WING四个字母中的任意一个字母作为玩具的基本名字。然后<br>他会根据自己的喜好，将名字中任意一个字母用“WING”中任意两个字母代替，使得自己的名字能够扩充得很长。<br>现在，他想请你猜猜某一个很长的名字，最初可能是由哪几个字母变形过来的。</p>
<h1 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h1><p>第一行四个整数W、I、N、G。表示每一个字母能由几种两个字母所替代。接下来W行，每行两个字母,表示W可<br>以用这两个字母替代。接下来I行，每行两个字母,表示I可以用这两个字母替代。接下来N行，每行两个字母,表示N<br>可以用这两个字母替代。接下来G行，每行两个字母,表示G可以用这两个字母替代。最后一行一个长度不超过Len的<br>字符串。表示这个玩具的名字。</p>
<h1 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h1><p>一行字符串，该名字可能由哪些字母变形而得到。（按照WING的顺序输出）如果给的名字不能由任何一个字母<br>变形而得到则输出“The name is wrong!”</p>
<h1 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h1><p>1 1 1 1<br>II<br>WW<br>WW<br>IG<br>IIII</p>
<h1 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h1><p>IN</p>
<h1 id="HINT"><a href="#HINT" class="headerlink" title="HINT"></a>HINT</h1><p>W可以变成II所以IIII可以缩成WW<br>IN均能变成WW所以WW又可以缩成I或者N<br>所以最终答案应该按照“WING”的顺序输出IN<br>【数据范围】<br>100%数据满足Len&leq;200，W、I、N、G&leq;16</p>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p>区间dp入门题。<br>似乎还要加上记忆化。<br>f[i][j][k]表示区间[i-j]能否用k代替。<br>每次询问的时候枚举一下中间点就好了。</p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight cpp"><table><tr><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 205</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">0</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">	<span class="keyword">while</span>(ch&gt;<span class="string">'9'</span>||ch&lt;<span class="string">'0'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">1</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">while</span>(ch&lt;=<span class="string">'9'</span>&amp;&amp;ch&gt;=<span class="string">'0'</span>)&#123;x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+ch-<span class="string">'0'</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">return</span> f?-x:x;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> f[N][N][<span class="number">4</span>];</div><div class="line"><span class="keyword">int</span> a[N], t[<span class="number">4</span>], len, flag;</div><div class="line"><span class="keyword">char</span> str[N], ch[<span class="number">4</span>][<span class="number">20</span>][<span class="number">2</span>];</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">calc</span><span class="params">(<span class="keyword">char</span> ch)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(ch == <span class="string">'W'</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	<span class="keyword">if</span>(ch == <span class="string">'I'</span>) <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span>(ch == <span class="string">'N'</span>) <span class="keyword">return</span> <span class="number">2</span>;</div><div class="line">	<span class="keyword">if</span>(ch == <span class="string">'G'</span>) <span class="keyword">return</span> <span class="number">3</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">char</span> <span class="title">revcalc</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(x == <span class="number">0</span>) <span class="keyword">return</span> <span class="string">'W'</span>;</div><div class="line">	<span class="keyword">if</span>(x == <span class="number">1</span>) <span class="keyword">return</span> <span class="string">'I'</span>;</div><div class="line">	<span class="keyword">if</span>(x == <span class="number">2</span>) <span class="keyword">return</span> <span class="string">'N'</span>;</div><div class="line">	<span class="keyword">if</span>(x == <span class="number">3</span>) <span class="keyword">return</span> <span class="string">'G'</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(l == r) <span class="keyword">return</span> a[l] == k;</div><div class="line">	<span class="keyword">int</span> &amp;ans = f[l][r][k];</div><div class="line">	<span class="keyword">if</span>(ans != <span class="number">-1</span>) <span class="keyword">return</span> ans;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= t[k]; i++)</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = l; j &lt; r; j++)</div><div class="line">			<span class="keyword">if</span>(dfs(l, j, calc(ch[k][i][<span class="number">0</span>])) &amp;&amp; dfs(j+<span class="number">1</span>, r, calc(ch[k][i][<span class="number">1</span>])))</div><div class="line">				<span class="keyword">return</span> ans = <span class="number">1</span>;</div><div class="line">	<span class="keyword">return</span> ans = <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="built_in">memset</span>(f, <span class="number">-1</span>, <span class="keyword">sizeof</span> f);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) t[i] = read();</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= t[i]; j++)</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">"%s"</span>, ch[i][j]);</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%s"</span>, str+<span class="number">1</span>); len = <span class="built_in">strlen</span>(str+<span class="number">1</span>);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= len; i++) a[i] = calc(str[i]);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</div><div class="line">		<span class="keyword">if</span>(dfs(<span class="number">1</span>, len, i))</div><div class="line">			flag = <span class="built_in">putchar</span>(revcalc(i));</div><div class="line">	<span class="keyword">if</span>(!flag) <span class="built_in">puts</span>(<span class="string">"The name is wrong!"</span>);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></div>
	  
	  <div class="readmore"><a href="/2017/05/25/BZOJ-1055-HAOI2008-玩具取名/">Read More</a></div>
  
</section>


  
<section>
  <a href="/2017/05/22/BZOJ-3275-Number/" title="BZOJ 3275: Number" class="link">
    <p class="desc-name"><span class="title">BZOJ 3275: Number</span><time class="time">2017-05-22</time></p>
  </a>
  
	  
	    <div class="artc" ><h1 id="题面"><a href="#题面" class="headerlink" title="题面"></a>题面</h1><p>有$N$个正整数，需要从中选出一些数，使这些数的和最大。<br>若两个数$a,b$同时满足以下条件，则a,b不能同时被选</p>
<ol>
<li>存在正整数$C$，使$a^2+b^2=c^2$</li>
<li>$gcd(a,b)=1$</li>
</ol>
<h1 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h1><p>第一行一个正整数$n$，表示数的个数。<br>第二行$n$个正整数$a1,a2,…,an$。</p>
<h1 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h1><p>最大的和。</p>
<h1 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h1><p>5<br>3 4 5 6 7</p>
<h1 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h1><p>22</p>
<h1 id="HINT"><a href="#HINT" class="headerlink" title="HINT"></a>HINT</h1><p>$n\leq 3000$</p>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p>首先证明两个定理。</p>
<blockquote>
<p>定理1：两个奇数的平方和不可能是平方数。<br>证明：<br>首先我们知道以下定理<br>对于任意一个奇数$a$，$a^2=1\pmod 4$<br>对于任意一个偶数$b$，$b^2=0\pmod 4$<br>所以两个奇数的平方和$a_1^2+a_2^2=2\pmod 4$<br>这既不是奇数的平方也不是偶数的平方。<br>从而可以证明。</p>
<p>定理2：两个偶数gcd不可能是1<br>证明：<br>这不是废话吗。。。</p>
</blockquote>
<p>所以奇数对和偶数对均不能满足要求。<br>因此，可以将读入的数按奇偶分为两类。<br>之后跑二分图最大点权独立集即可。</p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight cpp"><table><tr><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 3010</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> M 1000000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">0</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">	<span class="keyword">while</span>(ch&gt;<span class="string">'9'</span>||ch&lt;<span class="string">'0'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">1</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">while</span>(ch&lt;=<span class="string">'9'</span>&amp;&amp;ch&gt;=<span class="string">'0'</span>)&#123;x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+ch-<span class="string">'0'</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">return</span> f?-x:x;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> to[M], nxt[M], head[M], cnt = <span class="number">1</span>, q[M];</div><div class="line"><span class="keyword">int</span> sum, n, od[N], ev[N], val[M], dis[N];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b?gcd(b,a%b):a;&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">sqr</span><span class="params">(<span class="keyword">int</span> a)</span></span>&#123;<span class="keyword">return</span> a*a;&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> v)</span></span>&#123;</div><div class="line">	to[++cnt] = y;</div><div class="line">	nxt[cnt] = head[x];</div><div class="line">	val[cnt] = v;</div><div class="line">	head[x] = cnt;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">bfs</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="built_in">memset</span>(dis, <span class="number">0</span>, <span class="keyword">sizeof</span> dis);</div><div class="line">	<span class="keyword">int</span> l = <span class="number">0</span>, r = <span class="number">1</span>; dis[<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">	<span class="keyword">while</span>(l &lt; r) <span class="keyword">for</span>(<span class="keyword">int</span> i = head[q[++l]]; i; i = nxt[i])</div><div class="line">		<span class="keyword">if</span>(!dis[to[i]] &amp;&amp; val[i])&#123;</div><div class="line">			dis[to[i]] = dis[q[l]]+<span class="number">1</span>;</div><div class="line">			<span class="keyword">if</span>(to[i] == n+<span class="number">1</span>) <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">			q[++r] = to[i];</div><div class="line">		&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> mn)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(x == n+<span class="number">1</span>) <span class="keyword">return</span> mn; <span class="keyword">int</span> sum = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = head[x]; i; i = nxt[i])</div><div class="line">		<span class="keyword">if</span>(dis[to[i]] == dis[x]+<span class="number">1</span> &amp;&amp; val[i])&#123;</div><div class="line">			<span class="keyword">int</span> k = dfs(to[i], min(mn-sum, val[i]));</div><div class="line">			<span class="keyword">if</span>(!k) dis[to[i]] = <span class="number">0</span>;</div><div class="line">			val[i] -= k; val[i^<span class="number">1</span>] += k; sum += k;</div><div class="line">			<span class="keyword">if</span>(sum == mn) <span class="keyword">break</span>;</div><div class="line">		&#125;</div><div class="line">	<span class="keyword">return</span> sum;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	n = read();</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</div><div class="line">		<span class="keyword">int</span> x = read(); sum += x;</div><div class="line">		<span class="keyword">if</span>(x&amp;<span class="number">1</span>) od[++od[<span class="number">0</span>]] = x;</div><div class="line">		<span class="keyword">else</span> ev[++ev[<span class="number">0</span>]] = x;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= od[<span class="number">0</span>]; i++)</div><div class="line">		add(<span class="number">0</span>, i, od[i]), add(i, <span class="number">0</span>, <span class="number">0</span>);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= ev[<span class="number">0</span>]; i++)</div><div class="line">		add(i+od[<span class="number">0</span>], n+<span class="number">1</span>, ev[i]), add(n+<span class="number">1</span>, i+od[<span class="number">0</span>], <span class="number">0</span>);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= od[<span class="number">0</span>]; i++) <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= ev[<span class="number">0</span>]; j++)</div><div class="line">		<span class="keyword">if</span>(gcd(od[i], ev[j]) == <span class="number">1</span>)&#123;</div><div class="line">			<span class="keyword">int</span> k = od[i]*od[i]+ev[j]*ev[j];</div><div class="line">			<span class="keyword">if</span>(sqr(<span class="built_in">sqrt</span>(k)+<span class="number">1e-9</span>) != k) <span class="keyword">continue</span>;</div><div class="line">			add(i, od[<span class="number">0</span>]+j, <span class="number">1</span>&lt;&lt;<span class="number">30</span>);</div><div class="line">			add(od[<span class="number">0</span>]+j, i, <span class="number">0</span>);</div><div class="line">		&#125;</div><div class="line">	<span class="keyword">int</span> ans = <span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span>(bfs())ans+=dfs(<span class="number">0</span>, <span class="number">1</span>&lt;&lt;<span class="number">30</span>);</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, sum-ans);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></div>
	  
	  <div class="readmore"><a href="/2017/05/22/BZOJ-3275-Number/">Read More</a></div>
  
</section>


  
<section>
  <a href="/2017/05/19/BZOJ-2843-极地旅行社/" title="BZOJ 2843: 极地旅行社" class="link">
    <p class="desc-name"><span class="title">BZOJ 2843: 极地旅行社</span><time class="time">2017-05-19</time></p>
  </a>
  
	  
	    <div class="artc" ><h1 id="题面"><a href="#题面" class="headerlink" title="题面"></a>题面</h1><p>不久之前，Mirko建立了一个旅行社，名叫“极地之梦”。这家旅行社在北极附近购买了N座冰岛，并且提供观光服务。当地最受欢迎的当然是帝企鹅了，这些小家伙经常成群结队的游走在各个冰岛之间。Mirko的旅行社遭受一次重大打击，以至于观光游轮已经不划算了。旅行社将在冰岛之间建造大桥，并用观光巴士来运载游客。Mirko希望开发一个电脑程序来管理这些大桥的建造过程，以免有不可预料的错误发生。这些冰岛从1到N标号。一开始时这些岛屿没有大桥连接，并且所有岛上的帝企鹅数量都是知道的。每座岛上的企鹅数量虽然会有所改变，但是始终在[0, 1000]之间。你的程序需要处理以下三种命令：</p>
<ol>
<li>“bridge A B”——在A与B之间建立一座大桥（A与B是不同的岛屿）。由于经费限制，这项命令被接受，当且仅当<br>A与B不联通。若这项命令被接受，你的程序需要输出”yes”，之<br>后会建造这座大桥。否则，你的程序需要输出”no”。</li>
<li>“penguins A X”——根据可靠消息，岛屿A此时的帝企鹅数量变为X。这项命令只是用来提供信息的，你的程序不<br>需要回应。</li>
<li>“excursion A B”——一个旅行团希望从A出发到B。若A与B连通，你的程序需要输出这个旅行团一路上所能看到的<br>帝企鹅数量（包括起点A与终点B），若不联通，你的程序需要输出”impossible”。</li>
</ol>
<h1 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h1><p>第一行一个正整数N，表示冰岛的数量。<br>第二行N个范围[0, 1000]的整数，为每座岛屿初始的帝企鹅数量。<br>第三行一个正整数M，表示命令的数量。接下来M行即命令，为题目描述所示。<br>$1\leq N\leq 30000,1\leq M\leq 100000$</p>
<h1 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h1><p>对于每个bridge命令与excursion命令，输出一行，为题目描述所示。</p>
<h1 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h1><p>5<br>4 2 4 5 6<br>10<br>excursion 1 1<br>excursion 1 2<br>bridge 1 2<br>excursion 1 2<br>bridge 3 4<br>bridge 3 5<br>excursion 4 5<br>bridge 1 3<br>excursion 2 4<br>excursion 2 5</p>
<h1 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h1><p>4<br>impossible<br>yes<br>6<br>yes<br>yes<br>15<br>yes<br>15<br>16</p>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p>LCT稳稳的1656ms</p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight cpp"><table><tr><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 30010</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">0</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">	<span class="keyword">while</span>(ch&gt;<span class="string">'9'</span>||ch&lt;<span class="string">'0'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">1</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">while</span>(ch&lt;=<span class="string">'9'</span>&amp;&amp;ch&gt;=<span class="string">'0'</span>)&#123;x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+ch-<span class="string">'0'</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">return</span> f?-x:x;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> c[N][<span class="number">2</span>], fa[N], rev[N], st[N], sum[N], val[N];</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isroot</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">	<span class="keyword">return</span> c[fa[x]][<span class="number">0</span>] != x &amp;&amp; c[fa[x]][<span class="number">1</span>] != x;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_up</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">	sum[x] = sum[c[x][<span class="number">0</span>]]+sum[c[x][<span class="number">1</span>]]+val[x];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_down</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(!rev[x])<span class="keyword">return</span>;</div><div class="line">	rev[x] ^= <span class="number">1</span>;</div><div class="line">	rev[c[x][<span class="number">0</span>]] ^= <span class="number">1</span>;</div><div class="line">	rev[c[x][<span class="number">1</span>]] ^= <span class="number">1</span>;</div><div class="line">	swap(c[x][<span class="number">0</span>], c[x][<span class="number">1</span>]);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> y = fa[x], z = fa[y];</div><div class="line">	<span class="keyword">int</span> r = c[y][<span class="number">0</span>] == x, l = r^<span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span>(!isroot(y)) c[z][c[z][<span class="number">0</span>]!=y] = x;</div><div class="line">	fa[x] = z; fa[y] = x; fa[c[x][r]] = y;</div><div class="line">	c[y][l] = c[x][r]; c[x][r] = y;</div><div class="line">	push_up(y); push_up(x);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">splay</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> top = <span class="number">0</span>; st[++top]=x;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = x; !isroot(i); i=fa[i])</div><div class="line">		st[++top] = fa[i];</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = top; i; i--)</div><div class="line">		push_down(st[i]);</div><div class="line">	<span class="keyword">while</span>(!isroot(x))&#123;</div><div class="line">		<span class="keyword">int</span> y = fa[x], z = fa[y];</div><div class="line">		<span class="keyword">if</span>(!isroot(y))<span class="keyword">if</span>(c[y][<span class="number">0</span>]==x^c[z][<span class="number">0</span>]==y)rotate(x);</div><div class="line">		<span class="keyword">else</span> rotate(y);</div><div class="line">		rotate(x);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">access</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> t = <span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span>(x)&#123;</div><div class="line">		splay(x);</div><div class="line">		c[x][<span class="number">1</span>] = t;</div><div class="line">		push_up(x);</div><div class="line">		t = x; x = fa[x];</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">rever</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">	access(x); splay(x);</div><div class="line">	rev[x]^=<span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">link</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</div><div class="line">	rever(x);</div><div class="line">	fa[x] = y;</div><div class="line">	splay(x);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">cut</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</div><div class="line">	rever(x); access(y); splay(y);</div><div class="line">	c[y][<span class="number">0</span>] = fa[x] = <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</div><div class="line">	rever(x); access(y); splay(y);</div><div class="line">	<span class="keyword">return</span> sum[y];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> v)</span></span>&#123;</div><div class="line">	rever(x);</div><div class="line">	val[x] = v;</div><div class="line">	push_up(x);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">	access(x); splay(x);</div><div class="line">	<span class="keyword">while</span>(c[x][<span class="number">0</span>]) x = c[x][<span class="number">0</span>];</div><div class="line">	<span class="keyword">return</span> x;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> n = read();</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</div><div class="line">		val[i] = sum[i] = read();</div><div class="line">	<span class="keyword">int</span> m = read(); <span class="keyword">char</span> ch[<span class="number">40</span>];</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, op, x, y; i &lt;= m; i++)&#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, ch); x = read(); y = read();</div><div class="line">		<span class="keyword">if</span>(ch[<span class="number">0</span>] == <span class="string">'b'</span>)</div><div class="line">			<span class="keyword">if</span>(find(x) == find(y)) <span class="built_in">puts</span>(<span class="string">"no"</span>);</div><div class="line">			<span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"yes"</span>), link(x, y);</div><div class="line">		<span class="keyword">if</span>(ch[<span class="number">0</span>] == <span class="string">'p'</span>)</div><div class="line">			change(x, y);</div><div class="line">		<span class="keyword">if</span>(ch[<span class="number">0</span>] == <span class="string">'e'</span>)</div><div class="line">			<span class="keyword">if</span>(find(x) != find(y)) <span class="built_in">puts</span>(<span class="string">"impossible"</span>);</div><div class="line">			<span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ask(x, y));</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></div>
	  
	  <div class="readmore"><a href="/2017/05/19/BZOJ-2843-极地旅行社/">Read More</a></div>
  
</section>


  
<section>
  <a href="/2017/05/17/BZOJ-2819-Nim/" title="BZOJ 2819: Nim" class="link">
    <p class="desc-name"><span class="title">BZOJ 2819: Nim</span><time class="time">2017-05-17</time></p>
  </a>
  
	  
	    <div class="artc" ><h1 id="题面"><a href="#题面" class="headerlink" title="题面"></a>题面</h1><p>著名游戏设计师vfleaking，最近迷上了Nim。普通的Nim游戏为：两个人进行游戏，N堆石子，每回合可以取其中某一堆的任意多个，可以取完，但不可以不取。谁不能取谁输。这个游戏是有必胜策略的。于是vfleaking决定写一个玩Nim游戏的平台来坑玩家。<br>为了设计漂亮一点的初始局面，vfleaking用以下方式来找灵感：拿出很多石子，把它们聚成一堆一堆的，对每一堆编号1,2,3,4,…n,在堆与堆间连边，没有自环与重边，从任意堆到任意堆都只有唯一一条路径可到达。然后他不停地进行如下操作：</p>
<ol>
<li>随机选两个堆v,u，询问若在v到u间的路径上的石子堆中玩Nim游戏，是否有必胜策略，如果有，vfleaking将会考虑将这些石子堆作为初始局面之一，用来坑玩家。</li>
<li>把堆v中的石子数变为k。</li>
</ol>
<p>由于vfleaking太懒了，他懒得自己动手了。请写个程序帮帮他吧。</p>
<h1 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h1><p>第一行一个数n，表示有多少堆石子。<br>接下来的一行，第i个数表示第i堆里有多少石子。<br>接下来n-1行，每行两个数v,u，代表v,u间有一条边直接相连。<br>接下来一个数q，代表操作的个数。<br>接下来q行，每行开始有一个字符：<br>如果是Q，那么后面有两个数v,u，询问若在v到u间的路径上的石子堆中玩Nim游戏，是否有必胜策略。<br>如果是C，那么后面有两个数v,k，代表把堆v中的石子数变为k。</p>
<p>对于100%的数据：<br>$1\leq N\leq 500000, 1\leq Q\leq 500000, 0\leq 任何时候每堆石子的个数\leq 32767$<br>其中有30%的数据：<br>石子堆组成了一条链，这3个点会导致你DFS时爆栈（也许你不用DFS？）。其它的数据DFS目测不会爆。</p>
<p>注意：石子数的范围是0到INT_MAX</p>
<h1 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h1><p>对于每个Q，输出一行Yes或No，代表对询问的回答。</p>
<h1 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h1><p>5<br>1 3 5 2 5<br>1 5<br>3 5<br>2 5<br>1 4<br>6<br>Q 1 2<br>Q 3 5<br>C 3 7<br>Q 1 2<br>Q 2 4<br>Q 5 3</p>
<h1 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h1><p>Yes<br>No<br>Yes<br>Yes<br>Yes</p>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p>LCA+树状数组<br>我还是照样用倍增求LCA、、</p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight cpp"><table><tr><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 500020</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> M 20</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">0</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">	<span class="keyword">while</span>(ch&gt;<span class="string">'9'</span>||ch&lt;<span class="string">'0'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">1</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">while</span>(ch&lt;=<span class="string">'9'</span>&amp;&amp;ch&gt;=<span class="string">'0'</span>)&#123;x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+ch-<span class="string">'0'</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">return</span> f?-x:x;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> to[N&lt;&lt;<span class="number">1</span>], nxt[N&lt;&lt;<span class="number">1</span>], head[N], cnt, ls[N];</div><div class="line"><span class="keyword">int</span> tot, fa[N][M], c[N], dep[N], a[N], rs[N];</div><div class="line"><span class="keyword">char</span> ch[<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> v)</span></span>&#123;</div><div class="line">	<span class="keyword">for</span>(;x&lt;N;x+=x&amp;-x)c[x]^=v;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> ans = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span>(;x;x^=x&amp;-x)ans^=c[x];</div><div class="line">	<span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">ins</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</div><div class="line">	to[++cnt] = y; nxt[cnt] = head[x]; head[x] = cnt;</div><div class="line">	to[++cnt] = x; nxt[cnt] = head[y]; head[y] = cnt;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> f)</span></span>&#123;</div><div class="line">	ls[x] = ++tot;</div><div class="line">	dep[x] = dep[f]+<span class="number">1</span>;</div><div class="line">	fa[x][<span class="number">0</span>] = f;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = head[x]; i; i = nxt[i])</div><div class="line">		<span class="keyword">if</span>(to[i] != f) dfs(to[i], x);</div><div class="line">	rs[x] = tot;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(dep[x] &lt; dep[y]) swap(x, y);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = M<span class="number">-1</span>; i &gt;= <span class="number">0</span>; i--)</div><div class="line">		<span class="keyword">if</span>(dep[fa[x][i]] &gt;= dep[y])</div><div class="line">			x = fa[x][i];</div><div class="line">	<span class="keyword">if</span>(x == y) <span class="keyword">return</span> x;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = M<span class="number">-1</span>; i &gt;= <span class="number">0</span>; i--)</div><div class="line">		<span class="keyword">if</span>(fa[x][i] != fa[y][i])</div><div class="line">			x = fa[x][i], y = fa[y][i];</div><div class="line">	<span class="keyword">return</span> fa[x][<span class="number">0</span>];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> n = read();</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) a[i] = read();</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) ins(read(), read());</div><div class="line">	dfs(<span class="number">1</span>, <span class="number">0</span>);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; M; j++)</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</div><div class="line">			<span class="keyword">if</span>(fa[i][j<span class="number">-1</span>]) fa[i][j] = fa[fa[i][j<span class="number">-1</span>]][j<span class="number">-1</span>];</div><div class="line">	<span class="keyword">int</span> m = read();</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</div><div class="line">		add(ls[i], a[i]), add(rs[i]+<span class="number">1</span>, a[i]);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)&#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, ch);<span class="keyword">int</span> x = read(), y = read();</div><div class="line">		<span class="keyword">if</span>(ch[<span class="number">0</span>] == <span class="string">'Q'</span>)</div><div class="line">			<span class="built_in">puts</span>(ask(ls[x])^ask(ls[y])^a[lca(x, y)] ? <span class="string">"Yes"</span>:<span class="string">"No"</span>);</div><div class="line">		<span class="keyword">else</span>&#123;</div><div class="line">			add(ls[x], a[x]), add(rs[x]+<span class="number">1</span>, a[x]);</div><div class="line">			a[x] = y;</div><div class="line">			add(ls[x], a[x]), add(rs[x]+<span class="number">1</span>, a[x]);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></div>
	  
	  <div class="readmore"><a href="/2017/05/17/BZOJ-2819-Nim/">Read More</a></div>
  
</section>


  
<section>
  <a href="/2017/05/16/BZOJ-3631-JLOI2014-松鼠的新家/" title="BZOJ 3631: [JLOI2014]松鼠的新家" class="link">
    <p class="desc-name"><span class="title">BZOJ 3631: [JLOI2014]松鼠的新家</span><time class="time">2017-05-16</time></p>
  </a>
  
	  
	    <div class="artc" ><h1 id="题面"><a href="#题面" class="headerlink" title="题面"></a>题面</h1><p>松鼠的新家是一棵树，前几天刚刚装修了新家，新家有n个房间，并且有n-1根树枝连接，每个房间都可以相互到达，且俩个房间之间的路线都是唯一的。天哪，他居然真的住在“树”上。松鼠想邀请小熊维尼前来参观，并且还指定一份参观指南，他希望维尼能够按照他的指南顺序，先去a1，再去a2，……，最后到an，去参观新家。<br>可是这样会导致维尼重复走很多房间，懒惰的维尼不听地推辞。可是松鼠告诉他，每走到一个房间，他就可以从房间拿一块糖果吃。维尼是个馋家伙，立马就答应了。<br>现在松鼠希望知道为了保证维尼有糖果吃，他需要在每一个房间各放至少多少个糖果。因为松鼠参观指南上的最后一个房间an是餐厅，餐厅里他准备了丰盛的大餐，所以当维尼在参观的最后到达餐厅时就不需要再拿糖果吃了。</p>
<h1 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h1><p>第一行一个整数n，表示房间个数<br>第二行n个整数，依次描述a1-an<br>接下来n-1行，每行两个整数x，y，表示标号x和y的两个房间之间有树枝相连。</p>
<h1 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h1><p>一共n行，第i行输出标号为i的房间至少需要放多少个糖果，才能让维尼有糖果吃。</p>
<h1 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h1><p>5<br>1 4 5 3 2<br>1 2<br>2 4<br>2 3<br>4 5</p>
<h1 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h1><p>1<br>2<br>1<br>2<br>1</p>
<h1 id="HINT"><a href="#HINT" class="headerlink" title="HINT"></a>HINT</h1><p>$2\leq n\leq 300000$</p>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p>感谢<a href="http://www.cnblogs.com/lcf-2000/p/6063211.html" target="_blank" rel="external">lcf2000</a>提供的思路。<br>用b数组表示每个点的糖果数。<br>对于每条路径$(u,v)$，只需要改变4个值：<br>$b[u]+1,b[fa[v]]+1,b[lca(u,v)]-1,b[fa[lca(u,v)]]-1$<br>然后$ans[i]=b[i]+\sum ans[son[i]]$。<br>P.S.我用倍增求LCA。<br>1A。开心~~</p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight cpp"><table><tr><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 300020</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> M 20</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">0</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">	<span class="keyword">while</span>(ch&gt;<span class="string">'9'</span>||ch&lt;<span class="string">'0'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">1</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">while</span>(ch&lt;=<span class="string">'9'</span>&amp;&amp;ch&gt;=<span class="string">'0'</span>)&#123;x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+ch-<span class="string">'0'</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">return</span> f?-x:x;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> to[N&lt;&lt;<span class="number">1</span>], nxt[N&lt;&lt;<span class="number">1</span>], head[N], cnt, fa[N][M], dep[N], b[N], a[N];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">ins</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</div><div class="line">	to[++cnt] = y; nxt[cnt] = head[x]; head[x] = cnt;</div><div class="line">	to[++cnt] = x; nxt[cnt] = head[y]; head[y] = cnt;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> f)</span></span>&#123;</div><div class="line">	fa[x][<span class="number">0</span>] = f;</div><div class="line">	dep[x] = dep[f]+<span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = head[x]; i; i = nxt[i])</div><div class="line">		<span class="keyword">if</span>(to[i] != f) dfs(to[i], x);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = head[x]; i; i = nxt[i])</div><div class="line">		<span class="keyword">if</span>(to[i] != fa[x][<span class="number">0</span>]) dfs(to[i]), b[x] += b[to[i]];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(dep[a] &lt; dep[b]) swap(a, b);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = M; i; i--)</div><div class="line">		<span class="keyword">if</span>(dep[fa[a][i<span class="number">-1</span>]] &gt;= dep[b])</div><div class="line">			a = fa[a][i<span class="number">-1</span>];</div><div class="line">	<span class="keyword">if</span>(a == b) <span class="keyword">return</span> a;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = M; i; i--)</div><div class="line">		<span class="keyword">if</span>(fa[a][i<span class="number">-1</span>] != fa[b][i<span class="number">-1</span>])</div><div class="line">			a = fa[a][i<span class="number">-1</span>], b = fa[b][i<span class="number">-1</span>];</div><div class="line">	<span class="keyword">return</span> fa[a][<span class="number">0</span>];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> n = read();</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) a[i] = read();</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) ins(read(), read());</div><div class="line">	dfs(<span class="number">1</span>, <span class="number">0</span>);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; M; j++)</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</div><div class="line">			<span class="keyword">if</span>(fa[i][j<span class="number">-1</span>]) fa[i][j] = fa[fa[i][j<span class="number">-1</span>]][j<span class="number">-1</span>];</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++)&#123;</div><div class="line">		<span class="keyword">int</span> lc = lca(a[i], a[i+<span class="number">1</span>]);</div><div class="line">		b[a[i]]++; b[fa[a[i+<span class="number">1</span>]][<span class="number">0</span>]]++;</div><div class="line">		b[lc]--; b[fa[lc][<span class="number">0</span>]]--;</div><div class="line">	&#125;</div><div class="line">	dfs(<span class="number">1</span>);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, b[i]);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></div>
	  
	  <div class="readmore"><a href="/2017/05/16/BZOJ-3631-JLOI2014-松鼠的新家/">Read More</a></div>
  
</section>


  
<section>
  <a href="/2017/05/11/BZOJ-4152-AMPPZ2014-The-Captain/" title="BZOJ 4152: [AMPPZ2014]The Captain" class="link">
    <p class="desc-name"><span class="title">BZOJ 4152: [AMPPZ2014]The Captain</span><time class="time">2017-05-11</time></p>
  </a>
  
	  
	    <div class="artc" ><h1 id="题面"><a href="#题面" class="headerlink" title="题面"></a>题面</h1><p>给定平面上的$n$个点，定义$(x1,y1)$到$(x2,y2)$的费用为$min(|x1-x2|,|y1-y2|)$，求从$1$号点走到$n$号点的最小费用。</p>
<h1 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h1><p>第一行包含一个正整数$n(2\leq n\leq 200000)$，表示点数。<br>接下来$n$行，每行包含两个整数$x[i],y[i](0\leq x[i],y[i]\leq 10^9)$，依次表示每个点的坐标。</p>
<h1 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h1><p>一个整数，即最小费用。</p>
<h1 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h1><p>5<br>2 2<br>1 1<br>4 5<br>7 1<br>6 7</p>
<h1 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h1><p>2</p>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p>这题有毒，<del>我Dijkstra写炸了调了一个钟头。</del><br>先按x轴坐标排序，然后把相邻的点连边（如果x轴的绝对值小于等于y轴的绝对值）。y轴同理。<br>然后跑dijkstra就好了</p>
<p>その足を止めないでよ<br>その両手で羽ばたけるから</p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight cpp"><table><tr><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 200020</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>&#123;</div><div class="line">	ll x=<span class="number">0</span>,f=<span class="number">0</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">	<span class="keyword">while</span>(ch&gt;<span class="string">'9'</span>||ch&lt;<span class="string">'0'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">1</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">while</span>(ch&lt;=<span class="string">'9'</span>&amp;&amp;ch&gt;=<span class="string">'0'</span>)&#123;x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+ch-<span class="string">'0'</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">return</span> f?-x:x;</div><div class="line">&#125;</div><div class="line"><span class="keyword">struct</span> node&#123;</div><div class="line">	<span class="keyword">int</span> x, y, id;</div><div class="line">&#125;a[N];</div><div class="line"><span class="keyword">struct</span> edge&#123;</div><div class="line">	<span class="keyword">int</span> to, nxt;</div><div class="line">	ll val;</div><div class="line">&#125;e[N&lt;&lt;<span class="number">2</span>];</div><div class="line"><span class="keyword">struct</span> qq&#123;</div><div class="line">	<span class="keyword">int</span> to;</div><div class="line">	ll val;</div><div class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> qq &amp;b) <span class="keyword">const</span> &#123;</div><div class="line">		<span class="keyword">return</span> val &gt; b.val;</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line">priority_queue&lt;qq&gt; q;</div><div class="line"><span class="keyword">int</span> head[N], cnt;</div><div class="line">ll dis[N];</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp1</span><span class="params">(node a, node b)</span></span>&#123;</div><div class="line">	<span class="keyword">return</span> a.x &lt; b.x;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp2</span><span class="params">(node a, node b)</span></span>&#123;</div><div class="line">	<span class="keyword">return</span> a.y &lt; b.y;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">ins</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, ll z)</span></span>&#123;</div><div class="line">	e[++cnt] = (edge)&#123;y, head[x], z&#125;; head[x] = cnt;</div><div class="line">	e[++cnt] = (edge)&#123;x, head[y], z&#125;; head[y] = cnt;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> n = read();</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</div><div class="line">		a[i].x = read(); a[i].y = read();</div><div class="line">		a[i].id = i;</div><div class="line">	&#125;</div><div class="line">	sort(a+<span class="number">1</span>, a+n+<span class="number">1</span>, cmp1);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) <span class="keyword">if</span>(a[i+<span class="number">1</span>].x-a[i].x &lt;= <span class="built_in">abs</span>(a[i].y-a[i+<span class="number">1</span>].y))</div><div class="line">		ins(a[i].id, a[i+<span class="number">1</span>].id, a[i+<span class="number">1</span>].x-a[i].x);</div><div class="line">	sort(a+<span class="number">1</span>, a+n+<span class="number">1</span>, cmp2);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) <span class="keyword">if</span>(a[i+<span class="number">1</span>].y-a[i].y &lt;= <span class="built_in">abs</span>(a[i].x-a[i+<span class="number">1</span>].x))</div><div class="line">		ins(a[i].id, a[i+<span class="number">1</span>].id, a[i+<span class="number">1</span>].y-a[i].y);</div><div class="line">	<span class="built_in">memset</span>(dis, <span class="number">127</span>/<span class="number">3</span>, <span class="keyword">sizeof</span> dis);</div><div class="line">	dis[<span class="number">1</span>] = <span class="number">0</span>;</div><div class="line">	q.push((qq)&#123;<span class="number">1</span>, <span class="number">0</span>&#125;);</div><div class="line">	<span class="keyword">while</span>(!q.empty())&#123;</div><div class="line">		qq tmp = q.top(); q.pop();</div><div class="line">		<span class="keyword">if</span>(dis[tmp.to] != tmp.val) <span class="keyword">continue</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = head[tmp.to]; i; i = e[i].nxt)&#123;</div><div class="line">			<span class="keyword">if</span>(dis[e[i].to] &gt; dis[tmp.to]+e[i].val)&#123;</div><div class="line">				dis[e[i].to] = dis[tmp.to]+e[i].val;</div><div class="line">				q.push((qq)&#123;e[i].to, dis[e[i].to]&#125;);</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, dis[n]);</div><div class="line">&#125;</div></pre></td></tr></table></figure></div>
	  
	  <div class="readmore"><a href="/2017/05/11/BZOJ-4152-AMPPZ2014-The-Captain/">Read More</a></div>
  
</section>



  <nav id="page-nav" class="clearfix">
    <a class="extend prev" rel="prev" href="/"><span></span>Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/3/">Next<span></span></a>
  </nav>

</div>
      </div>
      <aside class="sidebar">

  <div class="hitokoto">
  <p class="sidebar-title">一言</p>
  <div class="hitokoto-text" id="yiyan-text">Loading...</div>
  <div class="hitokoto-author" id="yiyan-author"></div>
  <script type="text/javascript">$.get("https://sslapi.hitokoto.cn/?c=ac",function(data){var yy=JSON.parse(data);$('#yiyan-text').html(yy.hitokoto);$('#yiyan-author').html('《'+yy.from+'》');})</script>
</div>

  <div class="linkslist">
  <p class="sidebar-title">友情链接</p>
  <div class="sidebar-main">
    <ul>
      <li><a href="https://shenzhebei.github.io/" target="_blank">SHENZHEBEI</a></li>
      <li><a href="http://blog.csdn.net/largecub233/" target="_blank">largecub233</a></li>
      <li><a href="http://blog.csdn.net/Fop_zz/" target="_blank">Fop_zz</a></li>
      <li><a href="http://blog.csdn.net/jzq233jzq/" target="_blank">jzq233jzq</a></li>
      <li><a href="https://zhzh2001.github.io/" target="_blank">zhzh2001</a></li>
      <li><a href="http://blog.csdn.net/mdnd1234/" target="_blank">mdnd</a></li>
      <li><a href="http://www.bilibili.com/" target="_blank">bilibili(乱入)</a></li>
      <li><a href="http://blog.csdn.net/zhouyuyang233/" target="_blank">zhouyuyang233</a></li>
      <li><a href="https://littleredstar.github.io/" target="_blank">black_moon</a></li>
      <li><a href="https://problem233.github.io/" target="_blank">problem233</a></li>
      <li><a href="http://blog.csdn.net/nn020701/" target="_blank">nn020701</a></li>
    </ul>
  </div>
</div>

</aside>
    </div>
    <footer>
      <p>Powered by <a href="https://hexo.io/" target="_view">Hexo</a> and theme by <a href="https://github.com/swwind/hacker" target="_view">Hacker</a></p>
    </footer>
    <!-- It must be a script element -->
  </body>
</html>

