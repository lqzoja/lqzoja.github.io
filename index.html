
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>SW_Wind&#39;s blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="SW_Wind">
    

    
    <meta property="og:type" content="website">
<meta property="og:title" content="SW_Wind's blog">
<meta property="og:url" content="http://swwind.github.io/index.html">
<meta property="og:site_name" content="SW_Wind's blog">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="SW_Wind's blog">

    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
    
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>
    <script type="text/javascript" async
      src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    <style type="text/css">
      ::selection {
        background:#7F7F7F;
      }
      pre {
        tab-size:4;
      }
    </style>
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="SW_Wind&#39;s blog" title="SW_Wind&#39;s blog"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="SW_Wind&#39;s blog">SW_Wind&#39;s blog</a></h1>
				<h2 class="blog-motto">Do you like Minecraft?</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:swwind.github.io">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main">

   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/04/13/BZOJ-3309-DZY-Loves-Math/" title="BZOJ 3309: DZY Loves Math" itemprop="url">BZOJ 3309: DZY Loves Math</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="SW_Wind" target="_blank" itemprop="author">SW_Wind</a>
		
  <p class="article-time">
    <time datetime="2017-04-13T01:21:30.000Z" itemprop="datePublished"> 发表于 2017-04-13</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h1 id="题面"><a href="#题面" class="headerlink" title="题面"></a>题面</h1><p>对于正整数$n$，定义$f(n)$为$n$所含质因子的最大幂指数。例如$f(1960)=f(2^3*5^1*7^2)=3$，$f(10007)=1$，$f(1)=0$。<br>给定正整数a、b，求$\sum_{i=1}^{a}{\sum_{j=1}^{b}{f(gcd(i,j))}}$</p>
<h1 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h1><p>第一行一个数T，表示询问数。<br>接下来T行，每行两个数a,b，表示一个询问。</p>
<h1 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h1><p>对于每一个询问，输出一行一个非负整数作为回答。</p>
<h1 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h1><p>4<br>7558588 9653114<br>6514903 4451211<br>7425644 1189442<br>6335198 4957</p>
<h1 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h1><p>35793453939901<br>14225956593420<br>4332838845846<br>15400094813</p>
<h1 id="HINT"><a href="#HINT" class="headerlink" title="HINT"></a>HINT</h1><p>【数据规模】<br>T&lt;=10000<br>1&lt;=a,b&lt;=10^7</p>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p>一眼就能看出来：<br>先枚举gcd<br>然后、、然后就又不会了<br>看题解吧。。<br>看到题解又跪了。。<a href="http://blog.csdn.net/popoqqq/article/details/42122413" target="_blank" rel="external">orz PoPoQQQ</a><br>$$<br>\begin{align}<br>ans<br>&amp;=\sum_{i=1}^{a}{\sum_{j=1}^{b}{f(gcd(i,j))}} \\<br>&amp;=\sum_{d=1}^{min(a,b)}{f(d)\sum_{k=1}^{min(\lfloor \frac{a}{d} \rfloor,\lfloor\frac{b}{d}\rfloor)}{\mu(k)\lfloor\frac{a}{kd}\rfloor\lfloor\frac{b}{kd}\rfloor}} \\<br>&amp;=\sum_{T=1}^{min(a,b)}{\lfloor\frac{a}{T}\rfloor\lfloor\frac{b}{T}\rfloor\sum_{d|T}{f(d)\mu(\frac{T}{d})}}<br>\end{align}<br>$$<br>现在我们只需要知道$\sum_{d|T}{f(d)\mu(\frac{T}{d})}$的前缀和就行了 设这个函数为$g(x)$<br>观察这个函数 由于含平方因子数的$\mu$值都为零，因此我们只考虑$\mu(\frac{T}{d})\neq0$的数<br>令$T=p_1^{a_1}p_2^{a_2}…p_k^{a_k}$，$d=p_1^{b_1}p_2^{b_2}…p_k^{b_k}$那么$0\le(ai-bi)\le1$<br>如果存在$a_i\neq a_j(i\neq j)$，那么我们可以将所有的$a$分为两部分：最大的$a$的集合$A$和非最大$a$的集合$B$<br>很显然$f$值由$A$中的选取方案决定<br>对于$A$中的每种选取方案，$\mu$值决定于总选择的数量的奇偶性<br>在集合$B$中选取奇数个元素和偶数个元素的方案数是相等的，故对于$A$中的每种选取方案，得到的和都是$0$<br>故如果存在$a_i\neq a_j(i\neq j)$，则$g(T)=0$<br>反之，如果所有的$a$值都相等，我们假设对于任意选取方案，$f$值都不变<br>那么由于选取奇数个元素和偶数个元素的方案数相等，和仍然为$0$<br>但是有一种选取方案的$f$值$=a-1$ 因此我们要将这个$1$减掉<br>考虑到$\mu$的符号之后，最终结果为$(-1)^{k+1}$<br>故如果不存在$a_i\neq a_j$，则$g(T)=(-1)^{k+1}$<br>不知道说明白了没有。。。（显然没有）<br>求出$g$函数的方法是线性筛 对于每个值记录$g$值和最小质因数的次数 具体细节见代码<br>别忘了开long long</p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 10000020</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line">ll _a[N], _p[N], _g[N];</div><div class="line"><span class="keyword">int</span> pri[N], cnt;</div><div class="line"><span class="keyword">bool</span> mark[N];</div><div class="line"><span class="function">ll <span class="title">calc</span><span class="params">(ll a, ll b)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(a &gt; b) swap(a, b);</div><div class="line">	ll ans = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, last; i &lt;= a; i = last+<span class="number">1</span>)&#123;</div><div class="line">		last = min(a/(a/i), b/(b/i));</div><div class="line">		ans += (a/i)*(b/i)*(_g[last]-_g[i<span class="number">-1</span>]);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; N; i++)&#123;</div><div class="line">		<span class="keyword">if</span>(!mark[i])&#123;pri[++cnt] = _p[i] = i; _a[i] = _g[i] = <span class="number">1</span>;&#125;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= cnt &amp;&amp; pri[j]*i &lt; N; j++)&#123;</div><div class="line">			mark[pri[j]*i] = <span class="number">1</span>;</div><div class="line">			<span class="keyword">if</span>(i%pri[j]==<span class="number">0</span>)&#123;</div><div class="line">				_a[pri[j]*i] = _a[i]+<span class="number">1</span>;</div><div class="line">				_p[pri[j]*i] = _p[i]*pri[j];</div><div class="line">				ll tmp = i/_p[i];</div><div class="line">				<span class="keyword">if</span>(tmp == <span class="number">1</span>) _g[pri[j]*i] = <span class="number">1</span>;</div><div class="line">				<span class="keyword">else</span> _g[pri[j]*i] = (_a[tmp]==_a[pri[j]*i]?-_g[tmp]:<span class="number">0</span>);</div><div class="line">				<span class="keyword">break</span>;</div><div class="line">			&#125;</div><div class="line">			_a[pri[j]*i] = <span class="number">1</span>;</div><div class="line">			_p[pri[j]*i] = pri[j];</div><div class="line">			_g[pri[j]*i] = (_a[i]==<span class="number">1</span>?-_g[i]:<span class="number">0</span>);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i++)</div><div class="line">		_g[i] += _g[i<span class="number">-1</span>];</div><div class="line">	<span class="keyword">int</span> T; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</div><div class="line">	<span class="keyword">while</span>(T--)&#123;</div><div class="line">		ll a, b;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>, &amp;a, &amp;b);</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, calc(a, b));</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/数论/">数论</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/2017/04/13/BZOJ-3309-DZY-Loves-Math/#disqus_thread" class="comments-count-link">Comments</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/04/13/BZOJ-4239-巴士走读/" title="BZOJ 4239: 巴士走读" itemprop="url">BZOJ 4239: 巴士走读</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="SW_Wind" target="_blank" itemprop="author">SW_Wind</a>
		
  <p class="article-time">
    <time datetime="2017-04-13T00:06:27.000Z" itemprop="datePublished"> 发表于 2017-04-13</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h1 id="题面"><a href="#题面" class="headerlink" title="题面"></a>题面</h1><p>大学生的JOI君每天乘坐巴士走读。<br>JOI君的家和学校都在IOI市内。IOI市内共有N个巴士停靠点，编号为1~N，离JOI家最近的停靠点为1号停靠点，离大学最近的停靠点为N号停靠点。<br>IOI市内共有M辆巴士，每辆巴士一天只跑一次，从某一时刻某一停靠点出发，在某一时刻到达另一个站点。运行途中不可以下车。<br>JOI君每天要乘坐一次以上的巴士到达学校。我们可以无视JOI君换车的时间，换言之，为了换乘某个时刻从某个停靠点出发的巴士，只需要在该巴士的出发时间或之前到达停靠点就可以了。此外，多次在某个停靠点换乘也是可以的。<br>在这样的条件下，JOI君想知道自己应该何时从家中出发才能按时赶到学校。然而，学校每天开始上课的时间都不同。在某Q天里，每天到达N号站点的最晚时间都是已知的，JOI君想知道，他最晚何时到达1号站点才能赶上学校的授课。<br>现在给你巴士的运营信息，以及这Q天里每天到达N号站点的最晚时间，请你求出每天JOI君最晚何时到达1号站点。</p>
<h1 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h1><p>第一行两个空格分隔的正整数N和M，表示IOI市内有N个巴士站点和M辆巴士。<br>接下来M行，第i行(1&lt;=i&lt;=M)有四个空格分隔的整数Ai,Bi,Xi,Yi(1&lt;=Ai&lt;=N,1&lt;=Bi&lt;=N,Ai≠Bi)，表示第i辆巴士在时刻Xi从停靠点Ai出发，在时刻Yi到达停靠点Bi。时刻从半夜12点开始计算，单位为毫秒。<br>接下来一行一个整数Q，含义如题目中所示<br>接下来Q行，第i行(1&lt;=i&lt;=Q)有一个整数Li，表示第i天最迟Li时刻到达站点N</p>
<h1 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h1><p>输出Q行，第i行(1&lt;=i&lt;=Q)一个整数，表示JOI君第i天最迟到达1号站点的时刻。<br>如果无法在时限内到达，输出-1。</p>
<h1 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h1><p>5 6<br>1 2 10 25<br>1 2 12 30<br>2 5 26 50<br>1 5 5 20<br>1 4 30 40<br>4 5 50 70<br>4<br>10<br>30<br>60<br>100</p>
<h1 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h1><p>-1<br>5<br>10<br>30</p>
<h1 id="HINT"><a href="#HINT" class="headerlink" title="HINT"></a>HINT</h1><p>2&lt;=N&lt;=100000<br>1&lt;=M&lt;=300000<br>0&lt;=Xi&lt;Yi&lt;86400000(=24*60*60*1000)(1&lt;=i&lt;=M)<br>1&lt;=Q&lt;=100000<br>0&lt;=Li&lt;86400000(1&lt;=i&lt;=Q)</p>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p>不知道怎么说。。答案显然是分段的<br>比如样例中：<br>$$<br>ans = \begin{cases}<br>-1, &amp; 0≤ans&lt;20 \\\\<br>5, &amp; 20≤ans&lt;50 \\\\<br>10, &amp; 50≤ans&lt;70 \\\\<br>30, &amp; 70≤ans&lt;∞ \\\\<br>\end{cases}<br>$$<br>所以离线是必然的<br>然后还是瞎搞一下。。<br>f[i]表示到达第i个点的最迟出发时间。。。<br>g[i]表示能赶上第i辆车的最迟出发时间、、、<br>然后两个互相更新，把所有终点为n的车的g[i]都统计出来，就能完美的解决了<br><del>（Sublime）对markdown的高亮有点萎啊</del></p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> M 300020</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 100020</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> x=<span class="number">0</span>, f=<span class="number">1</span>;<span class="keyword">char</span> ch = getchar();</div><div class="line">	<span class="keyword">while</span>(ch&gt;<span class="string">'9'</span>||ch&lt;<span class="string">'0'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">-1</span>;ch = getchar();&#125;</div><div class="line">	<span class="keyword">while</span>(ch&lt;=<span class="string">'9'</span>&amp;&amp;ch&gt;=<span class="string">'0'</span>)&#123;x = x*<span class="number">10</span>+ch-<span class="string">'0'</span>;ch = getchar();&#125;</div><div class="line">	<span class="keyword">return</span> x*f;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(x&gt;<span class="number">9</span>)write(x/<span class="number">10</span>);</div><div class="line">	<span class="built_in">putchar</span>(x%<span class="number">10</span>+<span class="string">'0'</span>);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">writeln</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(x&lt;<span class="number">0</span>)<span class="built_in">putchar</span>(<span class="string">'-'</span>), x=-x;</div><div class="line">	write(x); <span class="built_in">putchar</span>(<span class="string">'\n'</span>);</div><div class="line">&#125;</div><div class="line"><span class="keyword">struct</span> edge&#123;</div><div class="line">	<span class="keyword">int</span> x, y, st, ed;</div><div class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> edge &amp;b) <span class="keyword">const</span> &#123;</div><div class="line">		<span class="keyword">return</span> st &lt; b.st;</div><div class="line">	&#125;</div><div class="line">&#125;e[M];</div><div class="line"><span class="keyword">struct</span> node&#123;</div><div class="line">	<span class="keyword">int</span> x, y;</div><div class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> node &amp;b) <span class="keyword">const</span> &#123;</div><div class="line">		<span class="keyword">return</span> x &lt; b.x;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span> &gt; (<span class="keyword">const</span> node &amp;b) <span class="keyword">const</span> &#123;</div><div class="line">		<span class="keyword">return</span> x &gt; b.x;</div><div class="line">	&#125;</div><div class="line">&#125;ks[M], a[N];</div><div class="line"><span class="keyword">struct</span> My_Priority_Queue&#123;</div><div class="line">	node val[<span class="number">400010</span>];</div><div class="line">	<span class="keyword">int</span> size;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">up</span><span class="params">(<span class="keyword">int</span> pos)</span></span>&#123;</div><div class="line">		<span class="keyword">while</span>(pos&gt;<span class="number">1</span>&amp;&amp;val[pos]&lt;val[pos&gt;&gt;<span class="number">1</span>])</div><div class="line">			swap(val[pos], val[pos&gt;&gt;<span class="number">1</span>]),pos&gt;&gt;=<span class="number">1</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">down</span><span class="params">(<span class="keyword">int</span> pos)</span></span>&#123;</div><div class="line">		<span class="keyword">int</span> p = pos;</div><div class="line">		<span class="keyword">while</span>(<span class="number">1</span>)&#123;</div><div class="line">			<span class="keyword">if</span>((pos&lt;&lt;<span class="number">1</span>)&lt;=size&amp;&amp;val[pos&lt;&lt;<span class="number">1</span>]&lt;val[p])p=pos&lt;&lt;<span class="number">1</span>;</div><div class="line">			<span class="keyword">if</span>((pos&lt;&lt;<span class="number">1</span>|<span class="number">1</span>)&lt;=size&amp;&amp;val[pos&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]&lt;val[p])p=pos&lt;&lt;<span class="number">1</span>|<span class="number">1</span>;</div><div class="line">			<span class="keyword">if</span>(pos==p)<span class="keyword">return</span>; swap(val[pos], val[p]); pos=p;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">push</span><span class="params">(node d)</span></span>&#123;</div><div class="line">		val[++size]=d;</div><div class="line">		up(size);</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">pop</span><span class="params">()</span></span>&#123;</div><div class="line">		swap(val[<span class="number">1</span>], val[size--]);</div><div class="line">		down(<span class="number">1</span>);</div><div class="line">	&#125;</div><div class="line">	<span class="function">node <span class="title">top</span><span class="params">()</span></span>&#123;</div><div class="line">		<span class="keyword">return</span> val[<span class="number">1</span>];</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">empty</span><span class="params">()</span></span>&#123;</div><div class="line">		<span class="keyword">return</span> !size;</div><div class="line">	&#125;</div><div class="line">&#125;sw;</div><div class="line"><span class="keyword">int</span> f[N], g[M], ans[N], n, m, cnt;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="comment">// freopen("school.in", "r", stdin);</span></div><div class="line">	<span class="comment">// freopen("school.out", "w", stdout);</span></div><div class="line">	n = read(); m = read();</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)&#123;</div><div class="line">		e[i].x = read(); e[i].y = read();</div><div class="line">		e[i].st = read(); e[i].ed = read();</div><div class="line">	&#125;</div><div class="line">	sort(e+<span class="number">1</span>, e+m+<span class="number">1</span>);</div><div class="line">	<span class="built_in">memset</span>(f, <span class="number">-1</span>, <span class="keyword">sizeof</span> f); f[<span class="number">1</span>]=<span class="number">1</span>&lt;&lt;<span class="number">30</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)&#123;</div><div class="line">		<span class="keyword">while</span>(!sw.empty() &amp;&amp; sw.top().x&lt;=e[i].st)&#123;</div><div class="line">			node t = sw.top(); sw.pop();</div><div class="line">			f[e[t.y].y]=max(f[e[t.y].y], g[t.y]);</div><div class="line">		&#125;</div><div class="line">		g[i]=min(e[i].st, f[e[i].x]);</div><div class="line">		sw.push((node)&#123;e[i].ed, i&#125;);</div><div class="line">		<span class="keyword">if</span>(e[i].y == n)&#123;</div><div class="line">			ks[++cnt].x = e[i].ed;</div><div class="line">			ks[cnt].y = g[i];</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	sort(ks+<span class="number">1</span>, ks+cnt+<span class="number">1</span>);</div><div class="line">	<span class="keyword">int</span> T = read();</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i++)</div><div class="line">		a[i] = (node)&#123;read(), i&#125;;</div><div class="line">	sort(a+<span class="number">1</span>, a+T+<span class="number">1</span>);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, now = <span class="number">-1</span>, j = <span class="number">1</span>; i &lt;= T; i++)&#123;</div><div class="line">		<span class="keyword">for</span>(; j &lt;= cnt &amp;&amp; ks[j].x &lt;= a[i].x; j++)</div><div class="line">			now = max(now, ks[j].y);</div><div class="line">		ans[a[i].y] = now;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i++)</div><div class="line">		writeln(ans[i]);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/毒瘤题/">毒瘤题</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/2017/04/13/BZOJ-4239-巴士走读/#disqus_thread" class="comments-count-link">Comments</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/04/12/BZOJ-4240-有趣的家庭菜园/" title="BZOJ 4240: 有趣的家庭菜园" itemprop="url">BZOJ 4240: 有趣的家庭菜园</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="SW_Wind" target="_blank" itemprop="author">SW_Wind</a>
		
  <p class="article-time">
    <time datetime="2017-04-12T07:47:27.000Z" itemprop="datePublished"> 发表于 2017-04-12</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h1 id="题面"><a href="#题面" class="headerlink" title="题面"></a>题面</h1><p>对家庭菜园有兴趣的JOI君每年在自家的田地中种植一种叫做IOI草的植物。JOI君的田地沿东西方向被划分为N个区域，由西到东标号为1~N。IOI草一共有N株，每个区域种植着一株。在第i个区域种植的IOI草，在春天的时候高度会生长至hi，此后便不再生长。<br>为了观察春天的样子而出行的JOI君注意到了IOI草的配置与预定的不太一样。IOI草是一种非常依靠阳光的植物，如果某个区域的IOI草的东侧和西侧都有比它高的IOI草存在，那么这株IOI草就会在夏天之前枯萎。换句话说，为了不让任何一株IOI草枯萎，需要满足以下条件：<br>对于任意2&lt;=i&lt;=N-1，以下两个条件至少满足一个：</p>
<ol>
<li>对于任意1&lt;=j&lt;=i-1，hj&lt;=hi</li>
<li>对于任意i+1&lt;=j&lt;=N，hk&lt;=hi</li>
</ol>
<p>IOI草是非常昂贵的，为了不让IOI草枯萎，JOI君需要调换IOI草的顺序。IOI草非常非常的高大且纤细的植物，因此JOI君每次只能交换相邻两株IOI草。也就是说，JOI君每次需要选择一个整数i(1&lt;=i&lt;=N-1)，然后交换第i株IOI草和第i+1株IOI草。随着夏天临近，IOI草枯萎的可能性越来越大，因此JOI君想知道让所有IOI草都不会枯萎的最少操作次数。<br>现在给出田地的区域数，以及每株IOI草的高度，请你求出让所有IOI草的不会枯萎的最少操作次数。</p>
<h1 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h1><p>第一行一个正整数N，代表田地被分为了N个区域。<br>接下来N行，第i行(1&lt;=i&lt;=N)一个整数hi，表示第i株植物在春天时的高度</p>
<h1 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h1><p>输出一行一个整数，表示最少需要的操作次数</p>
<h1 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h1><p>6<br>2<br>8<br>4<br>5<br>3<br>6</p>
<h1 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h1><p>3</p>
<h1 id="HINT"><a href="#HINT" class="headerlink" title="HINT"></a>HINT</h1><p>最终的高度序列为 2 4 5 8 6 3，共需要操作三次。<br>3&lt;=N&lt;=3*10^5<br>1&lt;=hi&lt;=10^9</p>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p>摸你赛题（全班80%只有10分。。<br>反正题面就是要你找一个让序列成为单峰的最小移动步数</p>
<h2 id="错误的思想："><a href="#错误的思想：" class="headerlink" title="错误的思想："></a>错误的思想：</h2><p>预处理出[1-i]成为上升序列的最小移动步数和[i-n]成为下降序列的最小移动步数<br>然后枚举一下分界线统计一下就好了（然而只有10分）</p>
<h2 id="正解："><a href="#正解：" class="headerlink" title="正解："></a>正解：</h2><p>预处理出每个点往左移的最小步数和往右移的最小步数<br>然后枚举每一个点，考虑他往左移好还是往右移好（其实就是求左边有几个比他大的和右边有几个比他大的，这个用树状数组和离散化瞎搞一下就好了，左右取min）<br>再全部加起来就是答案了</p>
<p><del>我有同学树状数组写成九条可怜的了，还拿了90分。。</del></p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 300020</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>&#123;</div><div class="line">	ll x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">	<span class="keyword">while</span>(ch&gt;<span class="string">'9'</span>||ch&lt;<span class="string">'0'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">-1</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">while</span>(ch&lt;=<span class="string">'9'</span>&amp;&amp;ch&gt;=<span class="string">'0'</span>)&#123;x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">return</span> x*f;</div><div class="line">&#125;</div><div class="line">ll a[N], x[N], y[N], b[N], v[N], n, ans;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(ll x)</span></span>&#123;</div><div class="line">	<span class="keyword">for</span>(;x&lt;=n;x+=x&amp;-x)v[x]++;</div><div class="line">&#125;</div><div class="line"><span class="function">ll <span class="title">ask</span><span class="params">(ll x)</span></span>&#123;</div><div class="line">	ll ans = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span>(;x;x-=x&amp;-x)ans+=v[x];</div><div class="line">	<span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="comment">// freopen("flower.in", "r", stdin);</span></div><div class="line">	<span class="comment">// freopen("flower.out", "w", stdout);</span></div><div class="line">	n = read();</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</div><div class="line">		b[i] = a[i] = read();</div><div class="line">	sort(b+<span class="number">1</span>, b+n+<span class="number">1</span>);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</div><div class="line">		a[i] = lower_bound(b+<span class="number">1</span>, b+n+<span class="number">1</span>, a[i])-b;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</div><div class="line">		x[i] = i-ask(a[i])<span class="number">-1</span>;</div><div class="line">		add(a[i]);</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">memset</span>(v, <span class="number">0</span>, <span class="keyword">sizeof</span> v);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = n; i; i--)&#123;</div><div class="line">		y[i] = n-i-ask(a[i]);</div><div class="line">		add(a[i]);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++)</div><div class="line">		ans += min(x[i], y[i]);</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/树状数组/">树状数组</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/2017/04/12/BZOJ-4240-有趣的家庭菜园/#disqus_thread" class="comments-count-link">Comments</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/04/12/BZOJ-4236-JOIOJI/" title="BZOJ 4236: JOIOJI" itemprop="url">BZOJ 4236: JOIOJI</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="SW_Wind" target="_blank" itemprop="author">SW_Wind</a>
		
  <p class="article-time">
    <time datetime="2017-04-12T07:46:46.000Z" itemprop="datePublished"> 发表于 2017-04-12</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h1 id="题面"><a href="#题面" class="headerlink" title="题面"></a>题面</h1><p>JOIOJI桑是JOI君的叔叔。“JOIOJI”这个名字是由“J、O、I”三个字母各两个构成的。<br>最近，JOIOJI桑有了一个孩子。JOIOJI桑想让自己孩子的名字和自己一样由“J、O、I”三个字母构成，并且想让“J、O、I”三个字母的出现次数恰好相同。<br>JOIOJI桑家有一份祖传的卷轴，上面写着一首长诗，长度为N，由“J、O、I”三个字母组成。JOIOJIさん想用诗中最长的满足要求的连续子串作为孩子的名字。<br>现在JOIOJI桑将这首长诗交给了你，请你求出诗中最长的、包含同样数目的“J、O、I”三个字母的连续子串。</p>
<h1 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h1><p>第一行一个正整数N，代表这首长诗的长度<br>接下来一行一个长度为N的字符串S，表示这首长诗，保证每个字符都是“J、O、I”三个字母中的一个</p>
<h1 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h1><p>输出一行一个正整数，代表最长的包含等数量“J、O、I”三个字母的最长连续子串的长度。如果不存在这样的子串，输出0</p>
<h1 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h1><p>10<br>JOIIJOJOOI</p>
<h1 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h1><p>6</p>
<h1 id="HINT"><a href="#HINT" class="headerlink" title="HINT"></a>HINT</h1><p>选择“IIJOJO”这个子串，长度为6，包含“J、O、I”三个字母各2个，这是最长的满足要求的子串。<br>1&lt;=N&lt;=2*10^5</p>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p>听说可以用hash过。。<br>我这里直接用map水了2333</p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pii pair<span class="meta-string">&lt;int, int&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mk make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 200020</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, J, O, I, ans;</div><div class="line"><span class="keyword">char</span> s[N];</div><div class="line"><span class="built_in">map</span>&lt;pii, <span class="keyword">int</span>&gt; mp;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="comment">// freopen("name.in", "r", stdin);</span></div><div class="line">	<span class="comment">// freopen("name.out", "w", stdout);</span></div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%s"</span>, &amp;n, s+<span class="number">1</span>);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</div><div class="line">		<span class="keyword">if</span>(s[i] == <span class="string">'J'</span>) J++;</div><div class="line">		<span class="keyword">if</span>(s[i] == <span class="string">'O'</span>) O++;</div><div class="line">		<span class="keyword">if</span>(s[i] == <span class="string">'I'</span>) I++;</div><div class="line">		pii tmp = mk(J-O, O-I);</div><div class="line">		<span class="keyword">if</span>(!mp[tmp]) mp[tmp] = i;</div><div class="line">		<span class="keyword">else</span> ans = max(ans, i-mp[tmp]);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span>(J==O&amp;&amp;O==I) ans = n;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/STL/">STL</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/2017/04/12/BZOJ-4236-JOIOJI/#disqus_thread" class="comments-count-link">Comments</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/04/11/BZOJ-2693-jzptab-BZOJ-2154-Crash的数字表格/" title="BZOJ 2693: jzptab &amp; BZOJ 2154: Crash的数字表格" itemprop="url">BZOJ 2693: jzptab &amp; BZOJ 2154: Crash的数字表格</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="SW_Wind" target="_blank" itemprop="author">SW_Wind</a>
		
  <p class="article-time">
    <time datetime="2017-04-11T05:58:37.000Z" itemprop="datePublished"> 发表于 2017-04-11</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h1 id="题面"><a href="#题面" class="headerlink" title="题面"></a>题面</h1><p>都是要你求<br>$$\sum_{i=1}^{n} \sum_{j=1}^{m} lcm(i, j)$$</p>
<h1 id="Simple-Input"><a href="#Simple-Input" class="headerlink" title="Simple Input"></a>Simple Input</h1><p>4 5</p>
<h1 id="Simple-Output"><a href="#Simple-Output" class="headerlink" title="Simple Output"></a>Simple Output</h1><p>122</p>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p>不会做+看题解+公式恐惧症、、、<br>下面是某爬虫网站抄来的，也不知道作者是谁、、先orz一波</p>
<p>下面均设n&lt;=m<br>$$\sum_{i=1}^{n} \sum_{j=1}^{m} lcm(i, j) = \sum_{i=1}^{n} \sum_{j=1}^{m} \frac{ij}{(i,j)}$$<br>然后我们要想枚举$d=(i,j)$，那么就要确定$ij$怎么取，显然我们只需要先除去$i$和$j$的$d$，也就是$(i/d,j/d)=1$就行了，那么设<br>$$F(x, y) = \sum_{i=1}^{x} \sum_{j=1}^{y} ij[(i,j)=1]$$<br>那么原式变成<br>$$\sum_{d=1}^{n} \frac{d^2 F(\lfloor \frac{n}{d} \rfloor, \lfloor \frac{m}{d} \rfloor)}{d} = \sum_{d=1}^{n} d F(\lfloor \frac{n}{d} \rfloor, \lfloor \frac{m}{d} \rfloor)$$<br>考虑求$F(x,y)$<br>$$<br>\begin{align}<br>F(x, y) &amp; = \sum_{i=1}^{x} \sum_{j=1}^{y} ij[(i,j)=1] \\<br>&amp; = \sum_{i=1}^{x} \sum_{j=1}^{y} ij \sum_{d|(i,j)} \mu (d) \\<br>&amp; = \sum_{d=1}^{x} \mu (d) \sum_{d|i}^{x} i \sum_{d|j}^{y} j \\<br>&amp; = \sum_{d=1}^{x} \mu (d) d^2 \sum_{i=1}^{\lfloor \frac{x}{d} \rfloor} \sum_{j=1}^{\lfloor \frac{y}{d} \rfloor} 1 \\<br>&amp; = \sum_{d=1}^{x} \mu (d) d^2 \frac{\lfloor \frac{x}{d} \rfloor (\lfloor \frac{x}{d} \rfloor +1)}{2} \frac{\lfloor \frac{y}{d} \rfloor (\lfloor \frac{y}{d} \rfloor +1)}{2} \\<br>\end{align}<br>$$<br>带回原式得<br>$$<br>\begin{align}<br>&amp; \sum_{d=1}^{n} d F(\lfloor \frac{n}{d} \rfloor, \lfloor \frac{m}{d} \rfloor) \\<br>= &amp; \sum_{d=1}^{n} d \sum_{i=1}^{\lfloor \frac{n}{d} \rfloor} \mu (i) i^2 \frac{\lfloor \frac{\lfloor \frac{n}{d} \rfloor}{i} \rfloor (\lfloor \frac{\lfloor \frac{n}{d} \rfloor}{i} \rfloor +1)}{2} \frac{\lfloor \frac{\lfloor \frac{m}{d} \rfloor}{i} \rfloor (\lfloor \frac{\lfloor \frac{m}{d} \rfloor}{i} \rfloor +1)}{2} \\<br>= &amp; \sum_{d=1}^{n} d \sum_{i=1}^{\lfloor \frac{n}{d} \rfloor} \mu (i) i^2 \frac{\lfloor \frac{n}{di} \rfloor (\lfloor \frac{n}{di} \rfloor +1)}{2} \frac{\lfloor \frac{m}{di} \rfloor (\lfloor \frac{m}{di} \rfloor +1)}{2} \\<br>\end{align}<br>$$<br>现在已经可以$O(\sqrt n \sqrt n) = O(n)$单次查询了，可以完成那道数字表格了<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> zyy 20101009</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 10000020</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line">ll mu[N], pri[N], s[N], cnt;</div><div class="line"><span class="keyword">bool</span> mark[N];</div><div class="line">ll ans, x, y;</div><div class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>&#123;</div><div class="line">	ll x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">	<span class="keyword">while</span>(ch&gt;<span class="string">'9'</span>||ch&lt;<span class="string">'0'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">-1</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">while</span>(ch&lt;=<span class="string">'9'</span>&amp;&amp;ch&gt;=<span class="string">'0'</span>)&#123;x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">return</span> x*f;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(ll a)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(a&gt;<span class="number">9</span>)write(a/<span class="number">10</span>);</div><div class="line">	<span class="built_in">putchar</span>(a%<span class="number">10</span>+<span class="string">'0'</span>);</div><div class="line">&#125;</div><div class="line"><span class="function">ll <span class="title">sum</span><span class="params">(ll a, ll b)</span></span>&#123;</div><div class="line">	<span class="keyword">return</span> (a*(a+<span class="number">1</span>)/<span class="number">2</span>)%zyy*(b*(b+<span class="number">1</span>)/<span class="number">2</span>%zyy)%zyy;</div><div class="line">&#125;</div><div class="line"><span class="function">ll <span class="title">f</span><span class="params">(ll a, ll b)</span></span>&#123;</div><div class="line">	ll ans = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span>(ll i = <span class="number">1</span>, last; i &lt;= min(a, b); i = last+<span class="number">1</span>)&#123;</div><div class="line">		last = min(a/(a/i), b/(b/i));</div><div class="line">		ans = (ans+(s[last]-s[i<span class="number">-1</span>])*sum(a/i, b/i)%zyy)%zyy;</div><div class="line">		<span class="comment">// printf("ans  = %d\n", ans);</span></div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="built_in">cin</span> &gt;&gt; x &gt;&gt; y;</div><div class="line">	mu[<span class="number">1</span>] = <span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span>(ll i = <span class="number">2</span>; i &lt;= min(x, y); i++)&#123;</div><div class="line">		<span class="keyword">if</span>(!mark[i])pri[++cnt]=i,mu[i]=<span class="number">-1</span>;</div><div class="line">		<span class="keyword">for</span>(ll j = <span class="number">1</span>; j &lt;= cnt &amp;&amp; i*pri[j] &lt;= min(x, y); j++)&#123;</div><div class="line">			mark[pri[j]*i] = <span class="number">1</span>, mu[pri[j]*i] = -mu[i];</div><div class="line">			<span class="keyword">if</span>(i%pri[j]==<span class="number">0</span>)&#123;mu[pri[j]*i] = <span class="number">0</span>; <span class="keyword">break</span>;&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(ll i = <span class="number">1</span>; i &lt;= min(x, y); i++)</div><div class="line">		s[i] = (s[i<span class="number">-1</span>]+i*i*mu[i]%zyy)%zyy;</div><div class="line">	<span class="keyword">for</span>(ll i = <span class="number">1</span>, last; i &lt;= min(x, y); i = last+<span class="number">1</span>)&#123;</div><div class="line">		last = min(x/(x/i), y/(y/i));</div><div class="line">		ans = (ans+(i+last)*(last-i+<span class="number">1</span>)/<span class="number">2</span>%zyy*f(x/i, y/i)%zyy)%zyy;</div><div class="line">		<span class="comment">// printf("ans2 = %d\n", ans);</span></div><div class="line">	&#125;</div><div class="line">	<span class="built_in">cout</span>&lt;&lt;(ans+zyy)%zyy&lt;&lt;<span class="built_in">endl</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>但是交到第一题还是TLE，我们继续化简<br>令$T = di$，则$i|T,d = T/i$，换掉指标，得<br>$$<br>\begin{align}<br>&amp; \sum_{d=1}^{n} d \sum_{i=1}^{\lfloor \frac{n}{d} \rfloor} \mu (i) i^2 \frac{\lfloor \frac{n}{di} \rfloor (\lfloor \frac{n}{di} \rfloor +1)}{2} \frac{\lfloor \frac{m}{di} \rfloor (\lfloor \frac{m}{di} \rfloor +1)}{2} \\<br>= &amp;<br>\sum_{T=1}^{n} \frac{\lfloor \frac{n}{T} \rfloor (\lfloor \frac{n}{T} \rfloor +1)}{2} \frac{\lfloor \frac{m}{T} \rfloor (\lfloor \frac{m}{T} \rfloor +1)}{2} \sum_{i|T} \frac{T}{i} \mu (i) i^2 \\<br>= &amp; \sum_{T=1}^{n} \frac{\lfloor \frac{n}{T} \rfloor (\lfloor \frac{n}{T} \rfloor +1)}{2} \frac{\lfloor \frac{m}{T} \rfloor (\lfloor \frac{m}{T} \rfloor +1)}{2} T \sum_{i|T} \mu (i) i \\<br>\end{align}<br>$$<br>设$g(T)=T \sum_{i|T} \mu (i) i$，我们再设$f(T)=\sum_{i|T} \mu (i) i$那么$g(T)=Tf(T)$，考虑求$f(T)$<br>在线性筛中，外层为$k$，内层为$p_y$，所以求$f(kp_y)=\sum_{i|T} \mu(i) i$</p>
<p>当$p_y|k$时<br>当$i$取的数的因子中不包含新加入的$p_y$时，答案就是$f(k)$<br>当$i$取包含新加入的因子$p_y$时，由于此时$p_y$指数已经&gt;=2，所以$\mu (i)=0$，因此贡献为0<br>综上，当$p_y|k$时，答案为$f(k)$</p>
<p>当$p_y∤k$时<br>当$i$取的数的因子中不包含新加入的$p_y$时，同上，答案是$f(k)$<br>当$i$取的数的因子包含新加入的$p_y$时，由于指数为1，所以我们考虑$i=ap_y$，原式变为<br>$$\begin{align}<br>&amp; \sum_{i|T} \mu(i) i \\<br>= &amp; \sum_{ap_y|kp_y} \mu (ap_y) ap_y \\<br>= &amp; p_y \sum_{a|k} \mu (a) \mu(p_y) a \\<br>= &amp; -p_y \sum_{a|k} \mu(a) a \\<br>= &amp; -p_y f(k) \\<br>\end{align}$$<br>综上，当$p_y∤k$时，答案为$(1−p_y)f(k)$<br>然后线性筛随便搞搞即可，最后答案就是<br>$$\sum_{T=1}^{n} \frac{\lfloor \frac{n}{T} \rfloor (\lfloor \frac{n}{T} \rfloor +1)}{2} \frac{\lfloor \frac{m}{T} \rfloor (\lfloor \frac{m}{T} \rfloor +1)}{2} g(T)$$<br>$$F(x,y)= \sum_{i=1}^{x} \sum_{j=1}^{y} ij[(i,j)=1] = \sum_{i=1}^{x} \sum_{j=1}^{y} ij \sum_{d|(i,j)} \mu (d)$$</p>
<p>接着第一题也可以做了（小心被卡常数！<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> zyy 100000009</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 10000020</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> mu[N], pri[N], cnt;</div><div class="line">ll s[N];</div><div class="line"><span class="keyword">bool</span> mark[N];</div><div class="line">ll x, y;</div><div class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>&#123;</div><div class="line">	ll x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">	<span class="keyword">while</span>(ch&gt;<span class="string">'9'</span>||ch&lt;<span class="string">'0'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">-1</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">while</span>(ch&lt;=<span class="string">'9'</span>&amp;&amp;ch&gt;=<span class="string">'0'</span>)&#123;x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">return</span> x*f;</div><div class="line">&#125;</div><div class="line"><span class="function">ll <span class="title">sum</span><span class="params">(ll a, ll b)</span></span>&#123;</div><div class="line">	<span class="keyword">return</span> (a*(a+<span class="number">1</span>)/<span class="number">2</span>%zyy)*(b*(b+<span class="number">1</span>)/<span class="number">2</span>%zyy)%zyy;</div><div class="line">&#125;</div><div class="line"><span class="function">ll <span class="title">f</span><span class="params">(ll a, ll b)</span></span>&#123;</div><div class="line">	ll ans = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span>(ll i = <span class="number">1</span>, last; i &lt;= a; i = last+<span class="number">1</span>)&#123;</div><div class="line">		last = min(a/(a/i), b/(b/i));</div><div class="line">		ans = (ans+(s[last]-s[i<span class="number">-1</span>]+zyy)%zyy*sum(a/i, b/i)%zyy)%zyy;</div><div class="line">		<span class="comment">// printf("ans  = %d\n", ans);</span></div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	mu[<span class="number">1</span>] = s[<span class="number">1</span>] = <span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; N; i++)&#123;</div><div class="line">		<span class="keyword">if</span>(!mark[i])pri[++cnt]=i,mu[i]=<span class="number">-1</span>,s[i]=<span class="number">1</span>-i;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= cnt &amp;&amp; i*pri[j] &lt; N; j++)&#123;</div><div class="line">			mark[pri[j]*i] = <span class="number">1</span>;</div><div class="line">			<span class="keyword">if</span>(i%pri[j]==<span class="number">0</span>)&#123;mu[pri[j]*i] = <span class="number">0</span>; s[i*pri[j]]=s[i]; <span class="keyword">break</span>;&#125;</div><div class="line">			s[i*pri[j]] = (s[i]*s[pri[j]])%zyy; mu[pri[j]*i] = -mu[i];</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i++)</div><div class="line">		s[i] = (s[i<span class="number">-1</span>]+i*s[i]%zyy)%zyy;</div><div class="line">	<span class="keyword">int</span> T = read();</div><div class="line">	<span class="keyword">while</span>(T--)&#123;</div><div class="line">		x = read(); y = read();</div><div class="line">		<span class="keyword">if</span>(x &gt; y) swap(x, y);</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, (f(x, y)+zyy)%zyy);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>做完感觉人已经完全傻掉了<br>调了半个小时才知道BZOJ和cin cout有仇<br><img src="https://swwind.github.io/img/haipa.png"></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/数论/">数论</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/2017/04/11/BZOJ-2693-jzptab-BZOJ-2154-Crash的数字表格/#disqus_thread" class="comments-count-link">Comments</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/04/10/如何卡掉BZOJ/" title="如何卡掉BZOJ" itemprop="url">如何卡掉BZOJ</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="SW_Wind" target="_blank" itemprop="author">SW_Wind</a>
		
  <p class="article-time">
    <time datetime="2017-04-10T12:38:54.000Z" itemprop="datePublished"> 发表于 2017-04-10</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h1 id="警告"><a href="#警告" class="headerlink" title="警告"></a>警告</h1><p><strong>请不要利用任何黑客技术对网站进行恶意攻击，违者将追究法律责任，但与本博客无关</strong></p>
<h1 id="Linux下卡掉编译器"><a href="#Linux下卡掉编译器" class="headerlink" title="Linux下卡掉编译器"></a>Linux下卡掉编译器</h1><p>只需要写一句话<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;/dev/random&gt;</span></span></div></pre></td></tr></table></figure></p>
<p>然后编译器就被卡掉了2333，之前有一个人用这句话卡了两页的测评。。。</p>
<h1 id="Windows下卡掉编译器"><a href="#Windows下卡掉编译器" class="headerlink" title="Windows下卡掉编译器"></a>Windows下卡掉编译器</h1><p>也只要一句话<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;com1&gt;</span></span></div></pre></td></tr></table></figure></p>
<p>然后就愉快的爆蛋了</p>
<h1 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h1><p>我也不知道，自己谷歌</p>
<h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1><p><del>抵制不良游戏　拒绝盗版游戏　注意自我保护　谨防受骗上当<br>适度游戏益脑　沉迷游戏伤身　合理安排时间　享受健康生活</del><br>别作死卡OJ评测机，好好活着，不好吗？</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/2017/04/10/如何卡掉BZOJ/#disqus_thread" class="comments-count-link">Comments</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/04/10/BZOJ-4766-文艺计算姬/" title="BZOJ 4766: 文艺计算姬" itemprop="url">BZOJ 4766: 文艺计算姬</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="SW_Wind" target="_blank" itemprop="author">SW_Wind</a>
		
  <p class="article-time">
    <time datetime="2017-04-10T02:29:36.000Z" itemprop="datePublished"> 发表于 2017-04-10</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h1 id="题面"><a href="#题面" class="headerlink" title="题面"></a>题面</h1><p>“奋战三星期，造台计算机”。小W响应号召，花了三星期造了台文艺计算姬。文艺计算姬比普通计算机有更多的艺术细胞。普通计算机能计算一个带标号完全图的生成树个数，而文艺计算姬能计算一个带标号完全二分图的生成树个数。更具体地，给定一个一边点数为n，另一边点数为m，共有n*m条边的带标号完全二分图K_{n,m}，计算姬能快速算出其生成树个数。小W不知道计算姬算的对不对，你能帮助他吗？</p>
<h1 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h1><p>仅一行三个整数n,m,p，表示给出的完全二分图K_{n,m}<br>1 &lt;= n,m,p &lt;= 10^18</p>
<h1 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h1><p>仅一行一个整数，表示完全二分图K_{n,m}的生成树个数，答案需要模p。</p>
<h1 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h1><p>2 3 7</p>
<h1 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h1><p>5</p>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p><a href="http://www.cnblogs.com/neighthorn/p/6568410.html" target="_blank" rel="external">orz NeighThorn</a><br>答案其实就是m^(n-1)*n^(m-1)…<br>此外还要用到<strong>快速乘</strong>。？？一个长得和快速幂有点像的东西，可以防止乘法溢出。。<br>为毛他不开long long也能过得去啊(ノ=Д=)ノ┻━┻</p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line">ll n, m, p;</div><div class="line"><span class="function">ll <span class="title">mul</span><span class="params">(ll x, ll y)</span></span>&#123;</div><div class="line">	ll ans = <span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span>(y)&#123;</div><div class="line">		<span class="keyword">if</span>(y&amp;<span class="number">1</span>) ans = (ans+x)%p;</div><div class="line">		x = (x&lt;&lt;<span class="number">1</span>)%p; y &gt;&gt;= <span class="number">1</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"><span class="function">ll <span class="title">f</span><span class="params">(ll x, ll y)</span></span>&#123;</div><div class="line">	ll ans = <span class="number">1</span>;</div><div class="line">	<span class="keyword">while</span>(y)&#123;</div><div class="line">		<span class="keyword">if</span>(y&amp;<span class="number">1</span>) ans = mul(ans, x);</div><div class="line">		x = mul(x, x); y &gt;&gt;= <span class="number">1</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; p;</div><div class="line">	<span class="built_in">cout</span> &lt;&lt; mul(f(n, m<span class="number">-1</span>), f(m, n<span class="number">-1</span>)) &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/图论/">图论</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/2017/04/10/BZOJ-4766-文艺计算姬/#disqus_thread" class="comments-count-link">Comments</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/04/10/BZOJ-2002-Hnoi2010-Bounce-弹飞绵羊/" title="BZOJ 2002: [Hnoi2010]Bounce 弹飞绵羊" itemprop="url">BZOJ 2002: [Hnoi2010]Bounce 弹飞绵羊</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="SW_Wind" target="_blank" itemprop="author">SW_Wind</a>
		
  <p class="article-time">
    <time datetime="2017-04-10T00:44:29.000Z" itemprop="datePublished"> 发表于 2017-04-10</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h1 id="题面"><a href="#题面" class="headerlink" title="题面"></a>题面</h1><p>某天，Lostmonkey发明了一种超级弹力装置，为了在他的绵羊朋友面前显摆，他邀请小绵羊一起玩个游戏。游戏一开始，Lostmonkey在地上沿着一条直线摆上n个装置，每个装置设定初始弹力系数ki，当绵羊达到第i个装置时，它会往后弹ki步，达到第i+ki个装置，若不存在第i+ki个装置，则绵羊被弹飞。绵羊想知道当它从第i个装置起步时，被弹几次后会被弹飞。为了使得游戏更有趣，Lostmonkey可以修改某个弹力装置的弹力系数，任何时候弹力系数均为正整数。</p>
<h1 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h1><p>第一行包含一个整数n，表示地上有n个装置，装置的编号从0到n-1,接下来一行有n个正整数，依次为那n个装置的初始弹力系数。第三行有一个正整数m，接下来m行每行至少有两个数i、j，若i=1，你要输出从j出发被弹几次后被弹飞，若i=2则还会再输入一个正整数k，表示第j个弹力装置的系数被修改成k。<br>对于20%的数据n,m&lt;=10000。<br>对于100%的数据n&lt;=200000,m&lt;=100000。</p>
<h1 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h1><p>对于每个i=1的情况，你都要输出一个需要的步数，占一行。</p>
<h1 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h1><p>4<br>1 2 1 1<br>3<br>1 1<br>2 1 1<br>1 1</p>
<h1 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h1><p>2<br>3</p>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p>这题有两种做法。。但我只会分块。。LCT太恶心了，看了一个晚上就是看不懂他在干什么。。没事rever个毛线啊（听说是为了保证复杂度。。）<br>分块的话，直接一个块一个块跳。。具体我就不说了（<del>别问我怎么这么像hzwer的</del></p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 200020</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">	<span class="keyword">while</span>(ch&gt;<span class="string">'9'</span>||ch&lt;<span class="string">'0'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">-1</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">while</span>(ch&lt;=<span class="string">'9'</span>&amp;&amp;ch&gt;=<span class="string">'0'</span>)&#123;x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">return</span> x*f;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> n, st[N], pt[N], a[N], l[<span class="number">1020</span>], pos[N];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> block = <span class="built_in">sqrt</span>(n = read());</div><div class="line">	<span class="keyword">int</span> cnt = n/block;</div><div class="line">	<span class="keyword">if</span>(n%block) cnt++;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</div><div class="line">		a[i] = read();</div><div class="line">		pos[i] = (i<span class="number">-1</span>)/block+<span class="number">1</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= cnt; i++)</div><div class="line">		l[i] = (i<span class="number">-1</span>)*block+<span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = n; i; i--)</div><div class="line">		<span class="keyword">if</span>(i+a[i]&gt;n) st[i] = <span class="number">1</span>;</div><div class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(pos[i]==pos[i+a[i]])</div><div class="line">			st[i] = st[i+a[i]]+<span class="number">1</span>, pt[i] = pt[i+a[i]];</div><div class="line">		<span class="keyword">else</span> st[i] = <span class="number">1</span>, pt[i] = i+a[i];</div><div class="line">	<span class="keyword">int</span> m = read();</div><div class="line">	<span class="keyword">while</span>(m--)&#123;</div><div class="line">		<span class="keyword">int</span> op = read(), x = read()+<span class="number">1</span>, y = <span class="number">0</span>;</div><div class="line">		<span class="keyword">if</span>(op == <span class="number">1</span>)&#123;</div><div class="line">			<span class="keyword">while</span>(x)&#123;</div><div class="line">				y += st[x];</div><div class="line">				x = pt[x];</div><div class="line">			&#125;</div><div class="line">			<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, y);</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span>&#123;</div><div class="line">			a[x] = read();</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i = x; i &gt;= l[pos[x]]; i--)</div><div class="line">				<span class="keyword">if</span>(pos[i]==pos[i+a[i]])</div><div class="line">					st[i] = st[i+a[i]]+<span class="number">1</span>, pt[i] = pt[i+a[i]];</div><div class="line">				<span class="keyword">else</span> st[i] = <span class="number">1</span>, pt[i] = i+a[i];</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/分块/">分块</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/2017/04/10/BZOJ-2002-Hnoi2010-Bounce-弹飞绵羊/#disqus_thread" class="comments-count-link">Comments</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/04/07/BZOJ-3744-Gty的妹子序列/" title="BZOJ 3744: Gty的妹子序列" itemprop="url">BZOJ 3744: Gty的妹子序列</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="SW_Wind" target="_blank" itemprop="author">SW_Wind</a>
		
  <p class="article-time">
    <time datetime="2017-04-07T01:05:58.000Z" itemprop="datePublished"> 发表于 2017-04-07</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h1 id="题面"><a href="#题面" class="headerlink" title="题面"></a>题面</h1><p>我早已习惯你不在身边，<br>人间四月天 寂寞断了弦。<br>回望身后蓝天，<br>跟再见说再见……<br>某天,蒟蒻Autumn发现了从 Gty的妹子树(bzoj3720) 上掉落下来了许多妹子,他发现<br>她们排成了一个序列,每个妹子有一个美丽度。<br>Bakser神犇与他打算研究一下这个妹子序列,于是Bakser神犇问道:”你知道区间<br>[l,r]中妹子们美丽度的逆序对数吗?”<br>蒟蒻Autumn只会离线乱搞啊……但是Bakser神犇说道:”强制在线。”<br>请你帮助一下Autumn吧。<br>给定一个正整数序列a,对于每次询问,输出al…ar中的逆序对数,强制在线。、</p>
<h1 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h1><p>第一行包括一个整数n(1&lt;=n&lt;=50000),表示数列a中的元素数。<br>第二行包括n个整数a1…an(ai&gt;0,保证ai在int内)。<br>接下来一行包括一个整数m(1&lt;=m&lt;=50000),表示询问的个数。<br>接下来m行,每行包括2个整数l、r(1&lt;=l&lt;=r&lt;=n),表示询问al…ar中的逆序<br>对数(若ai&gt;aj且i&lt;j,则为一个逆序对)。<br>l,r要分别异或上一次询问的答案(lastans),最开始时lastans=0。<br>保证涉及的所有数在int内。</p>
<h1 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h1><p>对每个询问,单独输出一行,表示al…ar中的逆序对数。</p>
<h1 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h1><p>4<br>1 4 2 3<br>1<br>2 4</p>
<h1 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h1><p>2</p>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p>分块即可。（布吉岛的自己百度<br>就系把长度为 N 的序列分成 sqrt(N) 块啊，把这些块里的逆序对个数都预处理出来。<br>然后询问时多粗来的暴力求就好了嘛。。<br>问我怎么预处理？也是暴力啊、、<br>11784ms（把 i++ 都改成 ++i 会变慢。。。）</p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 50020</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">	<span class="keyword">while</span>(ch&gt;<span class="string">'9'</span>||ch&lt;<span class="string">'0'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">-1</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">while</span>(ch&lt;=<span class="string">'9'</span>&amp;&amp;ch&gt;=<span class="string">'0'</span>)&#123;x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">return</span> x*f;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> n, m, a[N], b[N], val[N];</div><div class="line"><span class="keyword">int</span> pos[N], st[N], rst[<span class="number">250</span>][N], btb[<span class="number">250</span>][<span class="number">250</span>];</div><div class="line"><span class="comment">// 树状数组</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">	<span class="keyword">for</span>(;x&lt;=n;x+=x&amp;-x)++val[x];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> ans = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span>(;x;x-=x&amp;-x)ans+=val[x];</div><div class="line">	<span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">work</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</div><div class="line">	<span class="built_in">memset</span>(val, <span class="number">0</span>, <span class="keyword">sizeof</span> val);</div><div class="line">	<span class="keyword">if</span>(pos[l]==pos[r])&#123;</div><div class="line">		<span class="keyword">int</span> ans = <span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span>(;l&lt;=r;--r)</div><div class="line">			ans += ask(a[r]<span class="number">-1</span>), add(a[r]);</div><div class="line">		<span class="keyword">return</span> ans;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">int</span> ans = btb[pos[l]+<span class="number">1</span>][pos[r]<span class="number">-1</span>], cnt = st[pos[r]]-st[pos[l]+<span class="number">1</span>];</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = st[pos[l]+<span class="number">1</span>]<span class="number">-1</span>; l &lt;= i; --i)&#123;</div><div class="line">		ans += ask(a[i]<span class="number">-1</span>)+rst[pos[r]<span class="number">-1</span>][a[i]<span class="number">-1</span>]-rst[pos[l]][a[i]<span class="number">-1</span>];</div><div class="line">		add(a[i]); ++cnt;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = st[pos[r]]; i &lt;= r; i++)&#123;</div><div class="line">		ans += cnt-ask(a[i])-rst[pos[r]<span class="number">-1</span>][a[i]]+rst[pos[l]][a[i]];</div><div class="line">		add(a[i]); ++cnt;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	n = read();</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</div><div class="line">		a[i] = b[i] = read();</div><div class="line">	sort(b+<span class="number">1</span>, b+n+<span class="number">1</span>);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</div><div class="line">		a[i] = lower_bound(b+<span class="number">1</span>, b+n+<span class="number">1</span>, a[i])-b;</div><div class="line">	<span class="keyword">int</span> size = <span class="built_in">sqrt</span>(n);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</div><div class="line">		pos[i] = (i<span class="number">-1</span>)/size+<span class="number">1</span>;</div><div class="line">	<span class="keyword">int</span> block = pos[n];</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= block; i++)</div><div class="line">		st[i] = size*(i<span class="number">-1</span>)+<span class="number">1</span>;</div><div class="line">	st[block+<span class="number">1</span>] = n+<span class="number">1</span>;</div><div class="line">	<span class="comment">// 偶就系要酱紫压行，你来咬偶啊</span></div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, cnt1=<span class="number">0</span>,cnt2=<span class="number">0</span>; i &lt;= block;</div><div class="line">			i++, cnt1=cnt2=<span class="number">0</span>, <span class="built_in">memcpy</span>(rst[i], rst[i<span class="number">-1</span>], <span class="keyword">sizeof</span> rst[i]),</div><div class="line">			<span class="built_in">memset</span>(val, <span class="number">0</span>, <span class="keyword">sizeof</span> val))</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = i; j &lt;= block; j++)</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> k = st[j]; k &lt; st[j+<span class="number">1</span>]; k++)&#123;</div><div class="line">				btb[i][j] = (cnt1 += cnt2-ask(a[k]));</div><div class="line">				add(a[k]); ++cnt2, ++rst[j][a[k]];</div><div class="line">			&#125;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= block; i++)</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">2</span>; j &lt;= n; j++)</div><div class="line">			rst[i][j] += rst[i][j<span class="number">-1</span>];</div><div class="line">	<span class="keyword">int</span> m = read(), lastans = <span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span>(m--)&#123;</div><div class="line">		<span class="keyword">int</span> l=read()^lastans, r=read()^lastans;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, lastans = work(l, r));</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/分块/">分块</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/2017/04/07/BZOJ-3744-Gty的妹子序列/#disqus_thread" class="comments-count-link">Comments</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/04/06/BZOJ-3674-可持久化并查集加强版/" title="BZOJ 3674: 可持久化并查集加强版" itemprop="url">BZOJ 3674: 可持久化并查集加强版</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="SW_Wind" target="_blank" itemprop="author">SW_Wind</a>
		
  <p class="article-time">
    <time datetime="2017-04-06T07:15:09.000Z" itemprop="datePublished"> 发表于 2017-04-06</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h1 id="题面"><a href="#题面" class="headerlink" title="题面"></a>题面</h1><p>自从zkysb出了可持久化并查集后……<br>hzwer:乱写能AC，暴力踩标程<br>KuribohG：我不路径压缩就过了！<br>ndsf：暴力就可以轻松虐！<br>zky:……</p>
<p>n个集合 m个操作<br>操作：<br>1 a b 合并a,b所在集合<br>2 k 回到第k次操作之后的状态(查询算作操作)<br>3 a b 询问a,b是否属于同一集合，是则输出1否则输出0<br>请注意本题采用强制在线,所给的a,b,k均经过加密,加密方法为x = x xor lastans,lastans的初始值为0<br>0&lt;n,m&lt;=2*10^5</p>
<h1 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h1><p>5 6<br>1 1 2<br>3 1 2<br>2 1<br>3 0 3<br>2 1<br>3 1 2</p>
<h1 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h1><p>1<br>0<br>1</p>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p><del>C++的rope真好用</del></p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ext/rope&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> __gnu_cxx;</div><div class="line">rope&lt;<span class="keyword">int</span>&gt; *rp[<span class="number">200010</span>]; <span class="comment">// 指针快qwq，把指针改成数组就RE了这又是为什么、、</span></div><div class="line"><span class="keyword">int</span> n, m, a[<span class="number">200100</span>], f, x, y, lastans;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> fa = rp[i] -&gt; at(x);</div><div class="line">	<span class="keyword">if</span>(fa==x) <span class="keyword">return</span> x;</div><div class="line">	<span class="keyword">int</span> f = find(i, fa);</div><div class="line">	<span class="keyword">if</span>(f==fa) <span class="keyword">return</span> f;</div><div class="line">	rp[i] -&gt; replace(x, f);</div><div class="line">	<span class="keyword">return</span> f;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</div><div class="line">		a[i] = i;</div><div class="line">	rp[<span class="number">0</span>] = <span class="keyword">new</span> rope&lt;<span class="keyword">int</span>&gt;(a, a+n+<span class="number">1</span>);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)&#123;</div><div class="line">		rp[i] = <span class="keyword">new</span> rope&lt;<span class="keyword">int</span>&gt;(*rp[i<span class="number">-1</span>]);</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;f);</div><div class="line">		<span class="keyword">if</span>(f == <span class="number">1</span>)&#123;</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</div><div class="line">			x^=lastans, y^=lastans;</div><div class="line">			x = find(i,x);</div><div class="line">			y = find(i,y);</div><div class="line">			<span class="keyword">if</span>(x != y)</div><div class="line">				rp[i] -&gt; replace(y, x);</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(f == <span class="number">2</span>)&#123;</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x); x^=lastans;</div><div class="line">			rp[i] = rp[x];</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span>&#123;</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</div><div class="line">			x^=lastans, y^=lastans;</div><div class="line">			<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, lastans=find(i,x)==find(i,y));</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/STL/">STL</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/2017/04/06/BZOJ-3674-可持久化并查集加强版/#disqus_thread" class="comments-count-link">Comments</a>
	
</div>

</footer>


    </article>







  <nav id="page-nav" class="clearfix">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/">Next<span></span></a>
  </nav>

</div>
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  


  

  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/数论/" title="数论">数论<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/线段树/" title="线段树">线段树<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/KMP/" title="KMP">KMP<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/dp/" title="dp">dp<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/博弈论/" title="博弈论">博弈论<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/Trie/" title="Trie">Trie<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/树状数组/" title="树状数组">树状数组<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/分块/" title="分块">分块<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/STL/" title="STL">STL<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/启发式搜索/" title="启发式搜索">启发式搜索<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/迭代加深搜索/" title="迭代加深搜索">迭代加深搜索<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Java/" title="Java">Java<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/蒙特卡罗/" title="蒙特卡罗">蒙特卡罗<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/bfs/" title="bfs">bfs<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/毒瘤题/" title="毒瘤题">毒瘤题<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/图论/" title="图论">图论<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/模拟/" title="模拟">模拟<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/minecraft/" title="minecraft">minecraft<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/主席树/" title="主席树">主席树<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/AC自动机/" title="AC自动机">AC自动机<sup>1</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="http://www.bilibili.com/" target="_blank" title="2333">bilibili</a>
            
          </li>
        
          <li>
            
            	<a href="https://shenzhebei.github.io/" target="_blank" title="dalao">szb</a>
            
          </li>
        
          <li>
            
            	<a href="http://blog.csdn.net/largecub233/" target="_blank" title="dalao">cfb</a>
            
          </li>
        
          <li>
            
            	<a href="http://blog.csdn.net/Fop_zz/" target="_blank" title="dalao">zxh</a>
            
          </li>
        
          <li>
            
            	<a href="http://blog.csdn.net/jzq233jzq/" target="_blank" title="dalao">jzq</a>
            
          </li>
        
          <li>
            
            	<a href="https://zhzh2001.github.io/" target="_blank" title="dalao">zz</a>
            
          </li>
        
          <li>
            
            	<a href="http://blog.csdn.net/mdnd1234/" target="_blank" title="dalao">mdnd</a>
            
          </li>
        
          <li>
            
            	<a href="http://blog.csdn.net/zhouyuyang233/" target="_blank" title="orzdalao">zyy</a>
            
          </li>
        
          <li>
            
            	<a href="https://littleredstar.github.io/" target="_blank" title="真·GAY">ljz</a>
            
          </li>
        
          <li>
            
            	<a href="https://problem233.github.io/" target="_blank" title="orz">ryj</a>
            
          </li>
        
    </ul>
</div>

  


</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> 作为一只蒟蒻 <br/>
			我就不说什么了233</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2017 
		
		<a href="/about" target="_blank" title="SW_Wind">SW_Wind</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
        
    }
  });
});
</script>










<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?e6d1f421bbc9962127a50488f9ed37d1";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
 </html>
